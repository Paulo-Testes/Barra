<?xml version="1.0" encoding="utf-8"?>
<inherited BaseReport="..\..\..\..\..\..\FAST\gsr-designer-frx\designer-win-x64\sup\sup\sup\sup\gsr-reports\base\retrato.frx" BaseReportAbsolutePath="..\..\..\..\..\FAST\gsr-designer-frx\designer-win-x64\sup\sup\sup\sup\gsr-reports\base\retrato.frx" ScriptLanguage="CSharp" ReportInfo.Created="02/01/2024 10:35:21" ReportInfo.Modified="09/09/2025 11:40:28" ReportInfo.CreatorVersion="2025.1.10.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    private void parent_BndCabecalho_BeforePrint(object sender, EventArgs e)
    {
      string titulo1 = (String)Report.GetColumnValue(&quot;SqlModulo.titulo_1&quot;);
      string titulo2 = (String)Report.GetColumnValue(&quot;SqlModulo.titulo_2&quot;);

      if (string.IsNullOrWhiteSpace(titulo1) &amp;&amp; string.IsNullOrWhiteSpace(titulo2))
      {
        TxtTituloRelatorio.Top = TxtTituloModulo1.Top;
        TxtPeriodo.Top = TxtTituloModulo2.Top;
        BndCabecalho.Height = (float)75.6;
      } 
      else if (string.IsNullOrWhiteSpace(titulo1))
      {
        TxtPeriodo.Top = TxtTituloRelatorio.Top;
        TxtTituloRelatorio.Top = TxtTituloModulo2.Top;
        TxtTituloModulo2.Top = TxtTituloModulo1.Top;
        BndCabecalho.Height = (float)75.6;
      } 
      else if (string.IsNullOrWhiteSpace(titulo2))
      {
        TxtPeriodo.Top = TxtTituloRelatorio.Top;
        TxtTituloRelatorio.Top = TxtTituloModulo2.Top;
        BndCabecalho.Height = (float)75.6;
      }
      
      ImgBrasao.Height = BndCabecalho.Height;
      ImgLogo.Height = BndCabecalho.Height;
    }    
        
    private void parent_BndFiltro_BeforePrint(object sender, EventArgs e)
    {
      BndFiltro.Visible = !string.IsNullOrWhiteSpace((String)Report.GetParameterValue(&quot;filtro&quot;));
    }  
   
    private void parent_BndRodape_BeforePrint(object sender, EventArgs e)
    {
      if (string.IsNullOrWhiteSpace((String)Report.GetColumnValue(&quot;SqlEntidade.endereco&quot;))) 
      {
        TxtRodape.Top = TxtEndereco.Top;
        TxtPaginacao.Top = TxtEndereco.Top;
        TxtEndereco.Visible = false;
        BndRodape.Height = (float)15.12; 
      }
      
      TxtRodape.Text = (String)Report.GetColumnValue(&quot;SqlEntidade.sigla&quot;);

      long personalizado = (Int64)Report.GetParameterValue(&quot;personalizado&quot;);
      long imprimirUsuario = (Int64)Report.GetParameterValue(&quot;imprimirUsuario&quot;);
      long imprimirData = (Int64)Report.GetParameterValue(&quot;imprimirData&quot;);

      if (imprimirUsuario == 1)
      {
        TxtRodape.Text += &quot; | &quot; + (String)Report.GetColumnValue(&quot;SqlUsuario.nome&quot;) + (String)Report.GetColumnValue(&quot;SqlUsuario.ds_usuario&quot;);
      }

      if (personalizado == 1)
      {
        TxtRodape.Text += &quot; | PERSONALIZADO&quot;;
      }
      else if (personalizado == 2)
      {
        TxtRodape.Text += &quot; | EXCLUSIVO&quot;;
      }

      if (imprimirData == 1)
      {
        TxtRodape.Text += &quot; | &quot; + (DateTime)Report.GetVariableValue(&quot;Date&quot;);
      }
    }    
   
    private void Resultado_BeforePrint(object sender, EventArgs e)
    {
     
      string nome = ((String)Report.GetColumnValue(&quot;SqlHistorico.nome&quot;));
      string completo =  ((String)Report.GetColumnValue(&quot;SqlHistorico.nome_completo&quot;));
 
      Resultado.Visible = string.IsNullOrWhiteSpace(nome) &amp;&amp; string.IsNullOrWhiteSpace(completo);
    }
  }
}</ScriptText>
  <Dictionary>
    <PostgresDataConnection Name="Connection" ConnectionString="rijcmlqiSaocAniJQNoKNFeaTFzMe98Srvu/H0B5rG99iH0rlAD52+0S9jQVqtbGjnQ1fJfcaegeqkp60BrLd+YLnR4XqyfZaBNherXEOpLePTulRqrY+ChMEL6VHdEuu5eaQq8E+ZDa9Ad9YImM+XDJvP1OxFYb+FethvPPDDYdV8PdEE=">
      <TableDataSource Name="SqlEntidade" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Int32" Enabled="true" SelectCommand="select coalesce(enti.ds_entidade, lice.ds_licenciado) as nome&#13;&#10;     , pess.documento_formatado as cnpj&#13;&#10;     , lice.imagem as brasao&#13;&#10;     , coalesce(enti.sigla, lice.sigla) as sigla&#13;&#10;     , enti.imagem as logo&#13;&#10;     , case when enti.id_entidade is not null then ende.endereco end as endereco&#13;&#10;     , fone.contato as telefone&#13;&#10;     , mail.contato as email&#13;&#10;     , site.contato as site&#13;&#10;  from sis_licenciado            lice&#13;&#10;  left join sis_entidade         enti on enti.id_entidade        = :id_entidade&#13;&#10;  left join sis_pessoa           pess on pess.id_pessoa_juridica = enti.id_pessoa_juridica&#13;&#10;  left join sis_pessoa_endereco  ende on ende.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and ende.principal          = 1&#13;&#10;  left join sis_pessoa_contato   fone on fone.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and fone.id_tp_contato      = 2&#13;&#10;                                     and fone.principal          = true&#13;&#10;  left join sis_pessoa_contato   mail on mail.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and mail.id_tp_contato      = 1&#13;&#10;                                     and mail.principal          = true&#13;&#10;  left join sis_pessoa_contato   site on site.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and site.id_tp_contato      = 4&#13;&#10;                                     and site.principal          = true&#13;&#10; limit 1">
        <Column Name="nome" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="endereco" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="telefone" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="cnpj" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="brasao" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Byte[]" BindableControl="Picture"/>
        <Column Name="sigla" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="logo" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Byte[]" BindableControl="Picture"/>
        <Column Name="email" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="site" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <CommandParameter Name="id_entidade" DataType="9" Expression="[idEntidade]"/>
      </TableDataSource>
      <TableDataSource Name="SqlModulo" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Int32" Enabled="true" SelectCommand="select a.titulo_1&#13;&#10;     , a.titulo_2&#13;&#10;  from sis_modulo a&#13;&#10; where a.id_modulo = :id_modulo">
        <Column Name="titulo_1" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="titulo_2" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <CommandParameter Name="id_modulo" DataType="9" Expression="[idModulo]"/>
      </TableDataSource>
      <TableDataSource Name="SqlUsuario" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Int32" Enabled="true" SelectCommand="select log.nome&#13;&#10;     , case when usu.ds_usuario is not null then ' (' || trim(usu.ds_usuario) || ')' end as ds_usuario &#13;&#10;  from sis_login log &#13;&#10;  left join sis_usuario usu on usu.id_usuario = :id_usuario&#13;&#10; where log.id_login = :id_login&#13;&#10; limit 1">
        <Column Name="ds_usuario" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="nome" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <CommandParameter Name="id_login" DataType="9" Expression="[idLogin]"/>
        <CommandParameter Name="id_usuario" DataType="9" Expression="[idUsuario]"/>
      </TableDataSource>
      <TableDataSource Name="Table" Alias="SqlHistorico" DataType="System.Int32" Enabled="true" SelectCommand="SELECT&#13;&#10;  A.ID_AUT_HIST_CANCELAMENTO,&#13;&#10;  A.ID_AUTORIZACAO,&#13;&#10;  A.ID_USUARIO,&#13;&#10;  A.DT_ALTERACAO,&#13;&#10;  A.VALOR,&#13;&#10;  B.DS_USUARIO AS NOME,&#13;&#10;  B.NOME_USUARIO AS NOME_COMPLETO &#13;&#10;FROM&#13;&#10;  SUP_AUT_HIST_CANCELAMENTO A&#13;&#10;  LEFT JOIN SIS_USUARIO B ON B.id_usuario = A.ID_USUARIO&#13;&#10;WHERE&#13;&#10;  A.ID_AUTORIZACAO = :ID_AUTORIZACAO">
        <Column Name="id_aut_hist_cancelamento" DataType="System.Int32"/>
        <Column Name="id_autorizacao" DataType="System.Int32"/>
        <Column Name="id_usuario" DataType="System.Int32"/>
        <Column Name="dt_alteracao" DataType="System.DateTime"/>
        <Column Name="valor" DataType="System.Double"/>
        <Column Name="nome" DataType="System.String"/>
        <Column Name="nome_completo" DataType="System.String"/>
        <CommandParameter Name="id_autorizacao" DataType="9" Expression="[idAutorizacao]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="SqlAutorizacao" DataType="System.Int32" Enabled="true" SelectCommand="select A.ID_TP_AUTORIZACAO,&#13;&#10;       A.DT_AUTORIZACAO, &#13;&#10;       A.NR_AUTORIZACAO, &#13;&#10;       A.ANO_AUTORIZACAO, &#13;&#10;       A.COMPRADOR, &#13;&#10;       A.PRAZO_ENTREGA,&#13;&#10;       A.REPRESENTANTE, &#13;&#10;       A.LOCAL_ENTREGA, &#13;&#10;       A.FORMA_PAGTO, &#13;&#10;       C.DS_ST_AUTORIZACAO, &#13;&#10;       P.DOCUMENTO_FORMATADO, &#13;&#10;       P.NOME_RAZAO,&#13;&#10;       A.DT_ENVIO, A.REPRESENTANTE,&#13;&#10;       A.ESPECIFICACAO,&#13;&#10;       (select sum(S.VALOR)&#13;&#10;        from SUP_AUTORIZACAO_FICHA S&#13;&#10;        where S.ID_AUTORIZACAO = A.ID_AUTORIZACAO) as VALOR&#13;&#10;from SUP_AUTORIZACAO A&#13;&#10;left join VET_ST_AUTORIZACAO C on C.ID_ST_AUTORIZACAO = A.ID_ST_AUTORIZACAO&#13;&#10;left join SIS_PESSOA P on P.ID_PESSOA = A.ID_FORNECEDOR&#13;&#10;&#13;&#10;where A.ID_AUTORIZACAO = :ID_AUTORIZACAO">
        <Column Name="id_tp_autorizacao" DataType="System.Int16"/>
        <Column Name="dt_autorizacao" DataType="System.DateTime"/>
        <Column Name="nr_autorizacao" DataType="System.Int32"/>
        <Column Name="ano_autorizacao" DataType="System.Int32"/>
        <Column Name="comprador" DataType="System.String"/>
        <Column Name="prazo_entrega" DataType="System.Int16"/>
        <Column Name="representante" DataType="System.String"/>
        <Column Name="local_entrega" DataType="System.String"/>
        <Column Name="forma_pagto" DataType="System.String"/>
        <Column Name="ds_st_autorizacao" DataType="System.String"/>
        <Column Name="documento_formatado" DataType="System.String"/>
        <Column Name="nome_razao" DataType="System.String"/>
        <Column Name="dt_envio" DataType="System.DateTime"/>
        <Column Name="representante1" DataType="System.String"/>
        <Column Name="especificacao" DataType="System.String"/>
        <Column Name="valor" DataType="System.Double"/>
        <CommandParameter Name="id_autorizacao" DataType="9" Expression="[idAutorizacao]"/>
      </TableDataSource>
    </PostgresDataConnection>
    <Parameter Name="tituloRelatorio" DataType="System.String" Expression="&quot;HISTÓRICO DE VALOR DA AUTORIZAÇÃO&quot;"/>
    <Parameter Name="idEntidade" DataType="System.Int64" Expression="2"/>
    <Parameter Name="idModulo" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="idLogin" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="idRelatorioFiltro" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="periodo" DataType="System.String" Expression="&quot;&quot;"/>
    <Parameter Name="filtro" DataType="System.String" Expression="&quot;&quot;"/>
    <Parameter Name="personalizado" DataType="System.Int64" Expression="0"/>
    <Parameter Name="imprimirUsuario" DataType="System.Int64" Expression="1"/>
    <Parameter Name="imprimirData" DataType="System.Int64" Expression="1"/>
    <Parameter Name="idUsuario" DataType="System.Int64" Expression="3502"/>
    <Parameter Name="competencia" DataType="System.Int64" AsString=""/>
    <Parameter Name="idAutorizacao" DataType="System.Int64" Expression="1617"/>
    <Total Name="Total" Expression="[SqlHistorico.valor]" Evaluator="Data2"/>
  </Dictionary>
  <inherited Name="MainPage">
    <inherited Name="BndCabecalho">
      <inherited Name="ImgBrasao" ImageAlign="Center_Center"/>
      <inherited Name="TxtEntidade"/>
      <inherited Name="ImgLogo" ImageAlign="Center_Center"/>
      <inherited Name="TxtTituloModulo1"/>
      <inherited Name="TxtTituloModulo2"/>
      <inherited Name="TxtTituloRelatorio"/>
      <inherited Name="TxtPeriodo"/>
      <inherited Name="BndFiltro" Top="97.06">
        <inherited Name="TxtFiltro"/>
      </inherited>
    </inherited>
    <DataBand Name="Data1" ZOrder="0" Top="118.52" Width="718.2" Height="237.85">
      <TextObject Name="Text1" Top="42.8" Width="204.88" Height="24.95" Fill.Color="53, 103, 149" Text="[(IIf([SqlAutorizacao.id_tp_autorizacao] == 1, &quot;AF&quot;, &quot;AS&quot;))] [SqlAutorizacao.nr_autorizacao]/[[SqlAutorizacao.ano_autorizacao]]" VertAlign="Center" Font="Arial, 11pt, style=Bold" TextFill.Color="White">
        <Formats>
          <CustomFormat Format="00000"/>
          <CustomFormat Format="000000"/>
          <GeneralFormat/>
        </Formats>
      </TextObject>
      <TextObject Name="Text2" Top="68" Width="80.14" Height="20.03" Border.Lines="All" Text="Data:" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text3" Left="80.14" Top="68" Width="84.29" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="[SqlAutorizacao.dt_autorizacao]" Format="Custom" Format.Format="d" HorzAlign="Center" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      <TextObject Name="Text4" Left="164.43" Top="68" Width="49.9" Height="20.03" Border.Lines="All" Text="Valor:" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text5" Left="214.33" Top="68" Width="186.35" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="[SqlAutorizacao.valor]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="," Format.GroupSeparator="." Format.NegativePattern="1" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      <TextObject Name="Text6" Left="401.06" Top="68" Width="90.72" Height="20.03" Border.Lines="All" Text="Data envio:" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text7" Left="491.78" Top="68" Width="226.42" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="[SqlAutorizacao.dt_envio]" Format="Date" Format.Format="d" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      <TextObject Name="Text8" Top="88.48" Width="80.14" Height="20.03" Border.Lines="Left, Right, Bottom" Text="Fornecedor:" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text9" Left="80.05" Top="88.41" Width="638.06" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="[Trim([SqlAutorizacao.documento_formatado])] - [SqlAutorizacao.nome_razao]" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      <TextObject Name="Text10" Top="108.25" Width="80.14" Height="20.03" Border.Lines="Left, Right, Bottom" Text="Comprador:" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text11" Left="80.14" Top="108.07" Width="320.92" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="[Trim([SqlAutorizacao.comprador])]" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      <TextObject Name="Text12" Left="400.68" Top="108.07" Width="90.72" Height="20.03" Border.Lines="Left, Right, Bottom" Text="Representante:" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text13" Left="491.4" Top="108.07" Width="226.8" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="[Trim([SqlAutorizacao.representante])]" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      <TextObject Name="Text14" Top="151.2" Width="199.96" Height="20.03" Fill.Color="ButtonFace" Text="Observação" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text15" Top="171.1" Width="718.2" Height="20.03" Border.Lines="All" CanGrow="true" Text="[SqlAutorizacao.especificacao]" VertAlign="Center" Font="Tahoma, 8pt"/>
      <DataFooterBand Name="DataFooter1" Top="358.93" Width="718.2" Height="76.73">
        <TextObject Name="Text16" Top="56.7" Width="162.54" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="Data / Hora" HorzAlign="Center" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
        <TextObject Name="Text17" Left="162.54" Top="56.7" Width="396.9" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="Usuário" HorzAlign="Center" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
        <TextObject Name="Text18" Left="559.44" Top="56.7" Width="158.76" Height="20.03" Border.Lines="All" Fill.Color="ButtonFace" Text="Valor" HorzAlign="Center" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
        <ChildBand Name="Resultado" Top="438.22" Width="718.2" Height="94.5" BeforePrintEvent="Resultado_BeforePrint">
          <TextObject Name="Text19" Top="-1.3" Width="718.2" Height="94.5" Border.Lines="Left, Right, Bottom" BeforePrintEvent="Text19_BeforePrint" Text="Nenhum histórico encontrado." HorzAlign="Center" VertAlign="Center" Font="Arial, 10pt"/>
        </ChildBand>
      </DataFooterBand>
    </DataBand>
    <DataBand Name="Data2" ZOrder="1" Top="535.28" Width="718.2" Height="30.24" DataSource="Table">
      <TextObject Name="Text20" Width="162.54" Height="30.24" Border.Lines="Left, Right, Bottom" Text="[SqlHistorico.dt_alteracao]" HorzAlign="Justify" VertAlign="Center" Font="Tahoma, 8pt"/>
      <TextObject Name="Text21" Left="162.54" Width="396.9" Height="30.24" Border.Lines="Left, Right, Bottom" Text="[Trim([SqlHistorico.nome_completo])]&#13;&#10;Login: &lt;b&gt;[Trim([SqlHistorico.nome])]" HorzAlign="Justify" VertAlign="Center" Font="Tahoma, 8pt" TextRenderType="HtmlTags"/>
      <TextObject Name="Text22" Left="559.44" Width="158.76" Height="30.24" Border.Lines="Left, Right, Bottom" Text="[SqlHistorico.valor]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="," Format.GroupSeparator="." Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt"/>
      <DataFooterBand Name="DataFooter2" Top="568.08" Width="718.2" Height="41.96">
        <TextObject Name="Text23" Left="559.44" Width="158.76" Height="30.24" Border.Lines="All" Fill.Color="ButtonFace" Text="[Total]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="," Format.GroupSeparator="." Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Tahoma, 8pt, style=Bold"/>
      </DataFooterBand>
    </DataBand>
    <inherited Name="BndRodape" Top="612.6">
      <inherited Name="TxtRodape"/>
      <inherited Name="TxtPaginacao">
        <Formats>
          <GeneralFormat/>
          <GeneralFormat/>
        </Formats>
      </inherited>
      <inherited Name="TxtEndereco">
        <Formats>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
        </Formats>
      </inherited>
    </inherited>
  </inherited>
</inherited>
