<?xml version="1.0" encoding="utf-8"?>
<inherited BaseReport="..\..\..\..\..\..\Repositórios de Clientes\PESSOAS\gsr-reports\base\paisagem.frx" BaseReportAbsolutePath="..\..\..\..\..\..\Repositórios de Clientes\PESSOAS\gsr-reports\base\paisagem.frx" ScriptLanguage="CSharp" ReportInfo.Created="02/01/2024 10:35:21" ReportInfo.Modified="08/27/2025 09:05:43" ReportInfo.CreatorVersion="2025.1.10.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    private void parent_BndCabecalho_BeforePrint(object sender, EventArgs e)
    {
      string titulo1 = (String)Report.GetColumnValue(&quot;SqlModulo.titulo_1&quot;);
      string titulo2 = (String)Report.GetColumnValue(&quot;SqlModulo.titulo_2&quot;);

      if (string.IsNullOrWhiteSpace(titulo1) &amp;&amp; string.IsNullOrWhiteSpace(titulo2))
      {
        TxtTituloRelatorio.Top = TxtTituloModulo1.Top;
        TxtPeriodo.Top = TxtTituloModulo2.Top;
        BndCabecalho.Height = (float)75.6;
      } 
      else if (string.IsNullOrWhiteSpace(titulo1))
      {
        TxtPeriodo.Top = TxtTituloRelatorio.Top;
        TxtTituloRelatorio.Top = TxtTituloModulo2.Top;
        TxtTituloModulo2.Top = TxtTituloModulo1.Top;
        BndCabecalho.Height = (float)75.6;
      } 
      else if (string.IsNullOrWhiteSpace(titulo2))
      {
        TxtPeriodo.Top = TxtTituloRelatorio.Top;
        TxtTituloRelatorio.Top = TxtTituloModulo2.Top;
        BndCabecalho.Height = (float)75.6;
      }
      
      ImgBrasao.Height = BndCabecalho.Height;
      ImgLogo.Height = BndCabecalho.Height;
    }    
    
    private void parent_BndFiltro_BeforePrint(object sender, EventArgs e)
    {
      BndFiltro.Visible = !string.IsNullOrWhiteSpace((String)Report.GetParameterValue(&quot;filtro&quot;));
    }    
    
    private void parent_BndRodape_BeforePrint(object sender, EventArgs e)
    {
      if (string.IsNullOrWhiteSpace((String)Report.GetColumnValue(&quot;SqlEntidade.endereco&quot;))) 
      {
        TxtRodape.Top = TxtEndereco.Top;
        TxtPaginacao.Top = TxtEndereco.Top;
        TxtEndereco.Visible = false;
        BndRodape.Height = (float)15.12; 
      }
      
      TxtRodape.Text = (String)Report.GetColumnValue(&quot;SqlEntidade.sigla&quot;);

      long personalizado = (Int64)Report.GetParameterValue(&quot;personalizado&quot;);
      long imprimirUsuario = (Int64)Report.GetParameterValue(&quot;imprimirUsuario&quot;);
      long imprimirData = (Int64)Report.GetParameterValue(&quot;imprimirData&quot;);

      if (imprimirUsuario == 1)
      {
        TxtRodape.Text += &quot; | &quot; + (String)Report.GetColumnValue(&quot;SqlUsuario.nome&quot;) + (String)Report.GetColumnValue(&quot;SqlUsuario.ds_usuario&quot;);
      }

      if (personalizado == 1)
      {
        TxtRodape.Text += &quot; | PERSONALIZADO&quot;;
      }
      else if (personalizado == 2)
      {
        TxtRodape.Text += &quot; | EXCLUSIVO&quot;;
      }

      if (imprimirData == 1)
      {
        TxtRodape.Text += &quot; | &quot; + (DateTime)Report.GetVariableValue(&quot;Date&quot;);
      }
    }                                     
    //=============================================================================================================
                 
    private void bndN01_BeforePrint(object sender, EventArgs e)
    {
      int Nivel = ((Int32)Report.GetColumnValue(&quot;SqlFichaKardex.nivel&quot;));   
                 
      bndN01.Visible = Nivel == 1;
    }
                                    
    //============================================================================================================= 
    
    private void bndN02_BeforePrint(object sender, EventArgs e)
    {
      int Nivel = ((Int32)Report.GetColumnValue(&quot;SqlFichaKardex.nivel&quot;));
      
      bndN02.Visible = Nivel == 2;     
    }                                  
                       
    //=============================================================================================================    
  }
}</ScriptText>
  <Dictionary>
    <PostgresDataConnection Name="Connection" ConnectionString="rijcmlqiSaocAniJQNoKNFeaTFzMe98Srvu/H0B5rG99iH0rlAf45SGh+1JQ06HfUCwVjdXLyOtFr5FbmNWNqr1W8I2tPRGoPzSsFGNAQf85ceZvCGogRGJncwLI0VhpBoFVj/qSQKkbhjw8vK4wcDZgU0qxX2fo+F5nTj6MZsNTJlzZRo=">
      <TableDataSource Name="SqlEntidade" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Int32" PropName="Table" Enabled="true" SelectCommand="select coalesce(enti.ds_entidade, lice.ds_licenciado) as nome&#13;&#10;     , pess.documento_formatado as cnpj&#13;&#10;     , lice.imagem as brasao&#13;&#10;     , coalesce(enti.sigla, lice.sigla) as sigla&#13;&#10;     , enti.imagem as logo&#13;&#10;     , case when enti.id_entidade is not null then ende.endereco end as endereco&#13;&#10;     , fone.contato as telefone&#13;&#10;     , mail.contato as email&#13;&#10;     , site.contato as site&#13;&#10;  from sis_licenciado            lice&#13;&#10;  left join sis_entidade         enti on enti.id_entidade        = :id_entidade&#13;&#10;  left join sis_pessoa           pess on pess.id_pessoa_juridica = enti.id_pessoa_juridica&#13;&#10;  left join sis_pessoa_endereco  ende on ende.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and ende.principal          = 1&#13;&#10;  left join sis_pessoa_contato   fone on fone.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and fone.id_tp_contato      = 2&#13;&#10;                                     and fone.principal          = true&#13;&#10;  left join sis_pessoa_contato   mail on mail.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and mail.id_tp_contato      = 1&#13;&#10;                                     and mail.principal          = true&#13;&#10;  left join sis_pessoa_contato   site on site.id_pessoa          = pess.id_pessoa&#13;&#10;                                     and site.id_tp_contato      = 4&#13;&#10;                                     and site.principal          = true&#13;&#10; limit 1">
        <Column Name="nome" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="endereco" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="telefone" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="cnpj" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="brasao" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Byte[]" BindableControl="Picture"/>
        <Column Name="sigla" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="logo" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Byte[]" BindableControl="Picture"/>
        <Column Name="email" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="site" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <CommandParameter Name="id_entidade" DataType="9" Expression="[idEntidade]"/>
      </TableDataSource>
      <TableDataSource Name="SqlModulo" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Int32" PropName="Table2" Enabled="true" SelectCommand="select a.titulo_1&#13;&#10;     , a.titulo_2&#13;&#10;  from sis_modulo a&#13;&#10; where a.id_modulo = :id_modulo">
        <Column Name="titulo_1" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="titulo_2" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <CommandParameter Name="id_modulo" DataType="9" Expression="[idModulo]"/>
      </TableDataSource>
      <TableDataSource Name="SqlUsuario" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.Int32" PropName="Table1" Enabled="true" SelectCommand="select log.nome&#13;&#10;     , case when usu.ds_usuario is not null then ' (' || trim(usu.ds_usuario) || ')' end as ds_usuario &#13;&#10;  from sis_login log &#13;&#10;  left join sis_usuario usu on usu.id_usuario = :id_usuario&#13;&#10; where log.id_login = :id_login&#13;&#10; limit 1">
        <Column Name="ds_usuario" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <Column Name="nome" Restrictions="DontMove, DontResize, DontModify, DontEdit, DontDelete" DataType="System.String"/>
        <CommandParameter Name="id_login" DataType="9" Expression="[idLogin]"/>
        <CommandParameter Name="id_usuario" DataType="9" Expression="[idUsuario]"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="SqlFichaKardex" DataType="System.Int32" Enabled="true" SelectCommand="SELECT CAST(CASE WHEN B1.ID_SEQUENCIA = 1 THEN A1.CD_CLASSIFICACAO&#13;&#10;                 WHEN B1.ID_SEQUENCIA = 2 THEN A1.CD_CLASSIFICACAO || LPAD(CAST(A1.CD_UNIDADE_ESTOQUE AS VARCHAR(20)), 20, '0')&#13;&#10;            END  AS VARCHAR(250)) AS CHAVE&#13;&#10;&#13;&#10;     , B1.ID_SEQUENCIA AS NIVEL&#13;&#10;&#13;&#10;     , CAST(CASE WHEN B1.ID_SEQUENCIA = 1 THEN A1.CD_CLASSIFICACAO&#13;&#10;                 WHEN B1.ID_SEQUENCIA = 2 THEN CAST(A1.CD_UNIDADE_ESTOQUE AS VARCHAR(20))&#13;&#10;            END  AS VARCHAR(120)) AS CODIGO&#13;&#10;     , CAST(CASE WHEN B1.ID_SEQUENCIA = 1 THEN A1.DS_MATERIAL&#13;&#10;                 WHEN B1.ID_SEQUENCIA = 2 THEN A1.DS_UNIDADE_ESTOQUE&#13;&#10;            END  AS VARCHAR(250)) AS DESCRICAO&#13;&#10;     , CASE WHEN B1.ID_SEQUENCIA = 2 THEN A1.ID_UNIDADE_ESTOQUE END AS ID_UNIDADE_ESTOQUE&#13;&#10;     , A1.ID_MATERIAL&#13;&#10;     , CASE WHEN B1.ID_SEQUENCIA = 1 THEN 0 ELSE 1              END AS DETALHAR&#13;&#10;     , CASE WHEN B1.ID_SEQUENCIA = 1 THEN A1.UN_MATERIAL        END AS UN_MATERIAL&#13;&#10;     , ROUND(SUM(A1.QTD),           4) AS QTD&#13;&#10;     , ROUND(SUM(A1.VL_TOTAL),      2) AS VL_TOTAL&#13;&#10;     , ROUND(SUM(A1.CUSTO_MEDIO),   2) AS CUSTO_MEDIO&#13;&#10;  FROM (&#13;&#10;        SELECT F.ID_UNIDADE_ESTOQUE&#13;&#10;             , F.CD_UNIDADE_ESTOQUE&#13;&#10;             , F.DS_UNIDADE_ESTOQUE&#13;&#10;             , C.ID_MATERIAL&#13;&#10;             , C.CD_MATERIAL&#13;&#10;             , C.TP_MATERIAL&#13;&#10;             , C.DS_MATERIAL&#13;&#10;             , C.UN_MATERIAL&#13;&#10;             , C.LOCALIZACAO_FISICA&#13;&#10;             , E.CD_GRUPO&#13;&#10;             , D.CD_GRUPO AS CD_SUBGRUPO&#13;&#10;             , CAST(CAST(C.TP_MATERIAL           AS CHAR(1))               || '.' ||&#13;&#10;                         LPAD(CAST(E.CD_GRUPO    AS VARCHAR(20)), 3, '0')  || '.' ||&#13;&#10;                         LPAD(CAST(D.CD_GRUPO    AS VARCHAR(20)), 3, '0')  || '.' ||&#13;&#10;                         LPAD(CAST(C.CD_MATERIAL AS VARCHAR(20)), 6, '0')&#13;&#10;                         AS VARCHAR(120) )          AS CD_CLASSIFICACAO&#13;&#10;             , ROUND(COALESCE(F.QTD,      0), 4)    AS QTD&#13;&#10;             , ROUND(COALESCE(F.VL_TOTAL, 0), 2)    AS VL_TOTAL&#13;&#10;             , ROUND(COALESCE( ( SELECT B1.CUSTO_MEDIO&#13;&#10;                                   FROM SUP_LANCAMENTO_IT B1&#13;&#10;                                        LEFT JOIN SUP_LANCAMENTO A1 ON B1.ID_LANCAMENTO = A1.ID_LANCAMENTO&#13;&#10;                                  WHERE B1.ID_MATERIAL          = :ID_MATERIAL&#13;&#10;                                    AND A1.ID_ALMOXARIFADO      = :ID_ALMOXARIFADO&#13;&#10;                                    AND A1.ID_UNIDADE_ESTOQUE   = F.ID_UNIDADE_ESTOQUE&#13;&#10;                                    AND A1.DT_LANCAMENTO &lt;= TO_TIMESTAMP(:DT_INICIAL, 'DD/MM/YYYY')&#13;&#10;                                  ORDER BY A1.DT_LANCAMENTO DESC&#13;&#10;                                         , A1.ID_LANCAMENTO DESC&#13;&#10;                                         , B1.ID_LANCAMENTO_IT DESC&#13;&#10;                                   limit 1), 0), 2) AS CUSTO_MEDIO&#13;&#10;          FROM SUP_MATERIAL C&#13;&#10;               LEFT JOIN SUP_GRUPO  D ON D.ID_GRUPO     = C.ID_GRUPO&#13;&#10;               LEFT JOIN SUP_GRUPO  E ON E.ID_GRUPO     = D.ID_GRUPO_PAI&#13;&#10;               LEFT JOIN  (&#13;&#10;                             SELECT C1.ID_UNIDADE_ESTOQUE&#13;&#10;                                  , C1.CD_UNIDADE_ESTOQUE&#13;&#10;                                  , C1.DS_UNIDADE_ESTOQUE&#13;&#10;                                  , B1.ID_MATERIAL&#13;&#10;                                  , SUM(CASE WHEN A1.DT_LANCAMENTO &lt; TO_TIMESTAMP(:Dt_Inicial, 'DD/MM/YYYY')THEN B1.QTD ELSE 0 END) AS QTD&#13;&#10;                                  , SUM(CASE WHEN A1.DT_LANCAMENTO &lt; TO_TIMESTAMP(:Dt_Final,   'DD/MM/YYYY')THEN B1.QTD ELSE 0 END) AS VL_TOTAL&#13;&#10;                               FROM SUP_LANCAMENTO A1&#13;&#10;                                    INNER JOIN SUP_LANCAMENTO_IT   B1 ON B1.ID_LANCAMENTO       = A1.ID_LANCAMENTO&#13;&#10;                                    LEFT JOIN  SUP_UNIDADE_ESTOQUE C1 ON C1.ID_UNIDADE_ESTOQUE  = A1.ID_UNIDADE_ESTOQUE&#13;&#10;                              WHERE A1.ID_ALMOXARIFADO       = :ID_ALMOXARIFADO&#13;&#10;                                AND A1.DT_LANCAMENTO &lt;= TO_TIMESTAMP(:DT_FINAL, 'DD/MM/YYYY')&#13;&#10;                                AND (A1.ID_UNIDADE_ESTOQUE   = :ID_UNIDADE_ESTOQUE OR -1 = :ID_UNIDADE_ESTOQUE)&#13;&#10;                              GROUP BY 1,2,3,4&#13;&#10;        &#13;&#10;                          )         F ON F.ID_MATERIAL  = :ID_MATERIAL&#13;&#10;        &#13;&#10;         WHERE C.ID_MATERIAL = :ID_MATERIAL&#13;&#10;&#13;&#10;       ) A1&#13;&#10;       LEFT JOIN SIS_SEQUENCIA B1 ON B1.ID_SEQUENCIA &lt;= 2&#13;&#10;&#13;&#10; GROUP BY 1,2,3,4,5,6,7,8    &#13;&#10;&#13;&#10; ORDER BY 1">
        <Column Name="chave" DataType="System.String"/>
        <Column Name="nivel" DataType="System.Int32"/>
        <Column Name="codigo" DataType="System.String"/>
        <Column Name="descricao" DataType="System.String"/>
        <Column Name="id_unidade_estoque" DataType="System.Int32"/>
        <Column Name="id_material" DataType="System.Int32"/>
        <Column Name="detalhar" DataType="System.Int32"/>
        <Column Name="un_material" DataType="System.String"/>
        <Column Name="qtd" DataType="System.Double"/>
        <Column Name="vl_total" DataType="System.Double"/>
        <Column Name="custo_medio" DataType="System.Double"/>
        <CommandParameter Name="ID_MATERIAL" DataType="22" Expression="[idMaterial]"/>
        <CommandParameter Name="ID_ALMOXARIFADO" DataType="22" Expression="[idAlmoxarifado]"/>
        <CommandParameter Name="DT_INICIAL" DataType="22" Expression="[dataInicial]"/>
        <CommandParameter Name="dt_final" DataType="22" Expression="[dataFinal]"/>
        <CommandParameter Name="ID_UNIDADE_ESTOQUE" DataType="22" Expression="[idUnidadeEstoque]"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="SqlAlmoxarifado" DataType="System.Int32" Enabled="true" SelectCommand="SELECT A.CD_ALMOXARIFADO&#13;&#10;     , TRIM(A.DS_ALMOXARIFADO) AS DS_ALMOXARIFADO              &#13;&#10;  FROM SUP_ALMOXARIFADO A&#13;&#10; WHERE A.ID_ALMOXARIFADO = :ID_ALMOXARIFADO">
        <Column Name="cd_almoxarifado" DataType="System.Int32"/>
        <Column Name="ds_almoxarifado" DataType="System.String"/>
        <CommandParameter Name="ID_almoxarifado" DataType="22" Expression="[idAlmoxarifado]"/>
      </TableDataSource>
      <TableDataSource Name="Table3" Alias="SqlMaterial" DataType="System.Int32" Enabled="true" SelectCommand="SELECT A.CD_MATERIAL&#13;&#10;     , TRIM(A.DS_MATERIAL) AS DS_MATERIAL              &#13;&#10;  FROM SUP_MATERIAL A&#13;&#10; WHERE A.ID_MATERIAL = :ID_MATERIAL">
        <Column Name="cd_material" DataType="System.Int32"/>
        <Column Name="ds_material" DataType="System.String"/>
        <CommandParameter Name="ID_MATERIAL" DataType="22" Expression="[idMaterial]"/>
      </TableDataSource>
      <TableDataSource Name="Table4" Alias="SqlDetalhe" DataType="System.Int32" Enabled="true" SelectCommand="SELECT &#13;&#10;a1.id_almoxarifado, a1.id_unidade_estoque&#13;&#10;,A1.ID_MATERIAL&#13;&#10;     , A1.ID_LANCAMENTO&#13;&#10;     , A1.NR_LANCAMENTO&#13;&#10;     , A1.DT_LANCAMENTO&#13;&#10;     , A1.TP_LANCAMENTO&#13;&#10;     , A1.QTD_ENTRADA&#13;&#10;     , A1.VL_TOTAL_ENTRADA&#13;&#10;     , ROUND(CASE WHEN A1.QTD_ENTRADA &lt;&gt; 0 THEN A1.VL_TOTAL_ENTRADA / A1.QTD_ENTRADA ELSE 0 END, 2) AS CUSTO_MEDIO_ENTRADA&#13;&#10;     , A1.QTD_SAIDA&#13;&#10;     , A1.VL_TOTAL_SAIDA                                                                                                  &#13;&#10;     , ROUND(CASE WHEN A1.QTD_SAIDA &lt;&gt; 0 THEN A1.VL_TOTAL_SAIDA / A1.QTD_SAIDA ELSE 0 END, 2) AS CUSTO_MEDIO_SAIDA&#13;&#10;     , A1.QTD_ATUAL&#13;&#10;     , A1.CUSTO_MEDIO_ATUAL&#13;&#10;  FROM (&#13;&#10;        SELECT C.ID_MATERIAL&#13;&#10;        , a.id_almoxarifado, a.id_unidade_estoque&#13;&#10;             , A.ID_LANCAMENTO&#13;&#10;             , A.NR_LANCAMENTO&#13;&#10;             , A.DT_LANCAMENTO&#13;&#10;             , A.TP_LANCAMENTO&#13;&#10;             , ROUND(CASE WHEN A.TP_LANCAMENTO = 0   THEN B.QTD      ELSE 0 END, 4) AS QTD_ENTRADA&#13;&#10;             , ROUND(CASE WHEN A.TP_LANCAMENTO = 0   THEN B.VL_TOTAL ELSE 0 END, 2) AS VL_TOTAL_ENTRADA&#13;&#10;             , ROUND(CASE WHEN A.TP_LANCAMENTO = 1   THEN B.QTD      ELSE 0 END, 4) AS QTD_SAIDA&#13;&#10;             , ROUND(CASE WHEN A.TP_LANCAMENTO = 1   THEN B.VL_TOTAL ELSE 0 END, 2) AS VL_TOTAL_SAIDA&#13;&#10;             , ROUND((SELECT COALESCE(SUM(BB.QTD), 0)&#13;&#10;                        FROM SUP_LANCAMENTO_IT BB&#13;&#10;                             LEFT JOIN SUP_LANCAMENTO AA ON AA.ID_LANCAMENTO = BB.ID_LANCAMENTO&#13;&#10;                       WHERE BB.ID_MATERIAL           = B.ID_MATERIAL&#13;&#10;                         AND AA.ID_ALMOXARIFADO       = A.ID_ALMOXARIFADO&#13;&#10;                         AND AA.ID_UNIDADE_ESTOQUE    = A.ID_UNIDADE_ESTOQUE&#13;&#10;                         AND (AA.DT_LANCAMENTO        &lt; A.DT_LANCAMENTO  OR (AA.DT_LANCAMENTO = A.DT_LANCAMENTO AND AA.ID_LANCAMENTO     &lt; A.ID_LANCAMENTO   ) OR&#13;&#10;                             (AA.DT_LANCAMENTO        = A.DT_LANCAMENTO AND  AA.ID_LANCAMENTO = A.ID_LANCAMENTO AND BB.ID_LANCAMENTO_IT &lt;= B.ID_LANCAMENTO_IT)   )&#13;&#10;                     ), 4) AS QTD_ATUAL&#13;&#10;             , ROUND(B.CUSTO_MEDIO, 2) AS CUSTO_MEDIO_ATUAL&#13;&#10;          FROM SUP_LANCAMENTO        A&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_IT     B ON B.ID_LANCAMENTO        = A.ID_LANCAMENTO&#13;&#10;               LEFT JOIN SUP_MATERIAL          C ON C.ID_MATERIAL          = B.ID_MATERIAL&#13;&#10;               LEFT JOIN SUP_GRUPO             D ON D.ID_GRUPO             = C.ID_GRUPO&#13;&#10;               LEFT JOIN SUP_GRUPO             E ON E.ID_GRUPO             = D.ID_GRUPO_PAI&#13;&#10;               LEFT JOIN SUP_UNIDADE_ESTOQUE   F ON F.ID_UNIDADE_ESTOQUE   = A.ID_UNIDADE_ESTOQUE&#13;&#10;         WHERE A.ID_ALMOXARIFADO     = :ID_ALMOXARIFADO&#13;&#10;           AND A.ID_UNIDADE_ESTOQUE  = :ID_UNIDADE_ESTOQUE&#13;&#10;           AND B.ID_MATERIAL         = :ID_MATERIAL&#13;&#10;           and a.dt_lancamento &gt;= to_date(:Dt_inicial, 'DD/MM/YYYY') --'2024-01-01'&#13;&#10;           and a.dt_lancamento &lt;= TO_DATE(:dt_final, 'DD/MM/YYYY') --'2024-01-30'&#13;&#10;           /*limit 10*/&#13;&#10;       ) A1&#13;&#10; ORDER BY&#13;&#10;       A1.DT_LANCAMENTO, A1.NR_LANCAMENTO">
        <Column Name="id_material" DataType="System.Int32"/>
        <Column Name="id_lancamento" DataType="System.Int32"/>
        <Column Name="nr_lancamento" DataType="System.Int32"/>
        <Column Name="dt_lancamento" DataType="System.DateTime"/>
        <Column Name="tp_lancamento" DataType="System.Int16"/>
        <Column Name="qtd_entrada" DataType="System.Double"/>
        <Column Name="vl_total_entrada" DataType="System.Double"/>
        <Column Name="custo_medio_entrada" DataType="System.Double"/>
        <Column Name="qtd_saida" DataType="System.Double"/>
        <Column Name="vl_total_saida" DataType="System.Double"/>
        <Column Name="custo_medio_saida" DataType="System.Double"/>
        <Column Name="qtd_atual" DataType="System.Double"/>
        <Column Name="custo_medio_atual" DataType="System.Double"/>
        <Column Name="id_almoxarifado" DataType="System.Int32"/>
        <Column Name="id_unidade_estoque" DataType="System.Int32"/>
        <CommandParameter Name="id_almoxarifado" DataType="22" Expression="[idAlmoxarifado]"/>
        <CommandParameter Name="dt_inicial" DataType="22" Expression="[dataInicial]"/>
        <CommandParameter Name="dt_final" DataType="22" Expression="[dataFinal]"/>
        <CommandParameter Name="id_unidade_estoque" DataType="9" Expression="[SqlFichaKardex.id_unidade_estoque]"/>
        <CommandParameter Name="id_material" DataType="22" Expression="[idMaterial]"/>
      </TableDataSource>
      <TableDataSource Name="Table5" Alias="SqlUnidadeEstoque" DataType="System.Int32" Enabled="true" SelectCommand="SELECT A.CD_UNIDADE_ESTOQUE&#13;&#10;     , TRIM(A.DS_UNIDADE_ESTOQUE) AS DS_UNIDADE_ESTOQUE              &#13;&#10;  FROM SUP_UNIDADE_ESTOQUE A&#13;&#10; WHERE A.ID_UNIDADE_ESTOQUE = :ID_UNIDADE_ESTOQUE">
        <Column Name="cd_unidade_estoque" DataType="System.Int32"/>
        <Column Name="ds_unidade_estoque" DataType="System.String"/>
        <CommandParameter Name="id_unidade_estoque" DataType="22" Expression="[idUnidadeEstoque]"/>
      </TableDataSource>
      <TableDataSource Name="Table" Alias="SqlPeriodo" DataType="System.Int32" Enabled="true" SelectCommand=" SELECT &#13;&#10;  TO_DATE(:ANO_INI || '-' || LPAD(:MES_INI, 2, '0') || '-' || LPAD(:DIA_INI, 2, '0'), 'YYYY-MM-DD') AS DT_INICIO,&#13;&#10;  TO_DATE(:ANO_FIN || '-' || LPAD(:MES_FIN, 2, '0') || '-' || LPAD(:DIA_FIN, 2, '0'), 'YYYY-MM-DD') AS DT_FINAL&#13;&#10;FROM SIS_SEQUENCIA A&#13;&#10;WHERE A.ID_SEQUENCIA = 1">
        <Column Name="dt_inicio" DataType="System.DateTime"/>
        <Column Name="dt_final" DataType="System.DateTime"/>
        <CommandParameter Name="ANO_INI" DataType="22" Expression="ExtractYear([dataInicial])"/>
        <CommandParameter Name="MES_INI" DataType="22" Expression="ExtractMonth([dataInicial])"/>
        <CommandParameter Name="DIA_INI" DataType="22" Expression="ExtractDay([dataInicial])"/>
        <CommandParameter Name="ANO_FIN" DataType="22" Expression="ExtractYear([dataFinal])"/>
        <CommandParameter Name="MES_FIN" DataType="22" Expression="ExtractMonth([dataFinal])"/>
        <CommandParameter Name="DIA_FIN" DataType="22" Expression="ExtractDay([dataFinal])"/>
      </TableDataSource>
    </PostgresDataConnection>
    <Parameter Name="tituloRelatorio" DataType="System.String" Expression="&quot;Ficha Kardex&quot;"/>
    <Parameter Name="idEntidade" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="idModulo" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="idLogin" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="idUsuario" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="idRelatorioFiltro" DataType="System.Int64" Expression="-1"/>
    <Parameter Name="periodo" DataType="System.String" Expression="&quot;&quot;"/>
    <Parameter Name="filtro" DataType="System.String" Expression="&quot;&quot;"/>
    <Parameter Name="personalizado" DataType="System.Int64" Expression="0"/>
    <Parameter Name="imprimirUsuario" DataType="System.Int64" Expression="1"/>
    <Parameter Name="imprimirData" DataType="System.Int64" Expression="1"/>
    <Parameter Name="dataInicial" DataType="System.String" Expression="&quot;01/01/2010&quot;"/>
    <Parameter Name="dataFinal" DataType="System.String" Expression="&quot;31/12/2024&quot;"/>
    <Parameter Name="idAlmoxarifado" DataType="System.String" Expression="&quot;68&quot;"/>
    <Parameter Name="idUnidadeEstoque" DataType="System.String" Expression="&quot;84&quot;"/>
    <Parameter Name="idMaterial" DataType="System.String" Expression="&quot;102695&quot;"/>
  </Dictionary>
  <inherited Name="MainPage">
    <inherited Name="BndCabecalho">
      <inherited Name="ImgBrasao" ImageAlign="Center_Center"/>
      <inherited Name="TxtEntidade"/>
      <inherited Name="ImgLogo" ImageAlign="Center_Center"/>
      <inherited Name="TxtTituloModulo1"/>
      <inherited Name="TxtTituloModulo2"/>
      <inherited Name="TxtTituloRelatorio"/>
      <inherited Name="TxtPeriodo"/>
      <inherited Name="BndFiltro" Top="97.2">
        <inherited Name="TxtFiltro"/>
        <ChildBand Name="Child1" ZOrder="-1" Top="118.81" Width="1047.06" Height="18.9" CanGrow="true">
          <TextObject Name="Text48" Width="1047.06" Height="18.9" Text="Período entre &lt;b&gt;[DataInicial]&lt;/b&gt; e &lt;b&gt;[DataFinal]&lt;/b&gt;[IIf(ToInt32([IdAlmoxarifado]) != -1,Format( &quot;| Almoxarifado: &lt;b&gt;{0} - {1}&lt;/b&gt;&quot;, [SqlAlmoxarifado.cd_almoxarifado],[SqlAlmoxarifado.ds_almoxarifado]), &quot; &quot;)][IIf(ToInt32([idUnidadeEstoque]) != -1, Format(&quot; | Un. estoque: &lt;b&gt;{0} - {1}&lt;/b&gt;&quot;, [SqlUnidadeEstoque.CD_UNIDADE_ESTOQUE],[SqlUnidadeEstoque.DS_UNIDADE_ESTOQUE]), &quot;&quot;)][IIf(ToInt32[IdMaterial] != -1, Format(&quot; | Material: &lt;b&gt;{0} - {1}&lt;/b&gt;&quot;, [SqlMaterial.CD_MATERIAL], [SqlMaterial.DS_MATERIAL]), &quot;&quot;)]&#13;&#10;" Font="Arial, 6pt" TextRenderType="HtmlParagraph"/>
        </ChildBand>
      </inherited>
    </inherited>
    <ColumnHeaderBand Name="ColumnHeader1" ZOrder="-1" Top="140.41" Width="1047.06" Height="25.7">
      <TextObject Name="Text4" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="Classificação&#13;&#10;" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text5" Left="100.17" Top="12.85" Width="627.1" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="Descrição         " HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text6" Left="726.89" Top="12.85" Width="40.07" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="U.M." HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text7" Left="766.96" Top="12.85" Width="80.14" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="Quantidade" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text8" Left="847.1" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="Valor Total" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text9" Left="946.89" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="Custo Médio" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text2" Width="766.96" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="                    Material" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
      <TextObject Name="Text3" Left="766.96" Width="280.1" Height="12.85" Border.Lines="All" Border.Color="White" Fill.Color="41, 82, 118" Text="Saldo Anterior&#13;&#10;" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold" TextFill.Color="White"/>
    </ColumnHeaderBand>
    <DataBand Name="bndN01" ZOrder="0" Top="174.16" Width="1047.06" Height="12.1" BeforePrintEvent="bndN01_BeforePrint" DataSource="Table1">
      <TextObject Name="Text10" Width="100.17" Height="12.1" Text="[SqlFichaKardex.codigo]" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold"/>
      <TextObject Name="Text11" Left="100.17" Width="627.1" Height="12.1" Text="[SqlFichaKardex.descricao]" Font="Tahoma, 7pt, style=Bold"/>
      <TextObject Name="Text12" Left="766.96" Width="80.14" Height="12.1" Text="[SqlFichaKardex.QTD]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="4" HorzAlign="Right" Font="Tahoma, 7pt, style=Bold"/>
      <TextObject Name="Text13" Left="726.89" Width="40.07" Height="12.1" Text="[SqlFichaKardex.UN_MATERIAL]&#13;&#10;" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold"/>
      <TextObject Name="Text14" Left="847.1" Width="100.17" Height="12.1" Text="[SqlFichaKardex.VL_TOTAL]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Right" Font="Tahoma, 7pt, style=Bold"/>
      <TextObject Name="Text15" Left="946.89" Width="100.17" Height="12.1" Text="[SqlFichaKardex.CUSTO_MEDIO]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Right" Font="Tahoma, 7pt, style=Bold"/>
      <ChildBand Name="bndN02" Top="188.97" Width="1047.06" Height="12.1" BeforePrintEvent="bndN02_BeforePrint">
        <TextObject Name="Text16" Width="100.17" Height="12.1" Text="[SqlFichaKardex.codigo]" HorzAlign="Center" Font="Tahoma, 7pt, style=Bold"/>
        <TextObject Name="Text17" Left="100.17" Width="667.17" Height="12.1" Text="[SqlFichaKardex.descricao]" Font="Tahoma, 7pt, style=Bold"/>
        <TextObject Name="Text18" Left="766.96" Width="80.14" Height="12.1" Text="[SqlFichaKardex.QTD]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="4" HorzAlign="Right" Font="Tahoma, 7pt, style=Bold"/>
        <TextObject Name="Text20" Left="847.1" Width="100.17" Height="12.1" Text="[SqlFichaKardex.VL_TOTAL]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Right" Font="Tahoma, 7pt, style=Bold"/>
        <TextObject Name="Text21" Left="946.89" Width="100.17" Height="12.1" Text="[SqlFichaKardex.CUSTO_MEDIO]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Right" Font="Tahoma, 7pt, style=Bold"/>
      </ChildBand>
      <DataHeaderBand Name="cabRelatorio" Top="168.81" Width="1047.06" Height="2.65" RepeatOnEveryPage="true"/>
    </DataBand>
    <DataBand Name="Data1" ZOrder="1" Top="232.17" Width="1047.06" Height="12.85" DataSource="Table4">
      <TextObject Name="Text47" Left="947.27" Width="100.17" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.CUSTO_MEDIO_ATUAL]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text37" Left="99.79" Width="52.16" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.DT_LANCAMENTO]&#13;&#10;" Format="Date" Format.Format="dd/MM/yy" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text38" Left="151.96" Width="54.81" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.NR_LANCAMENTO]" Format="Custom" Format.Format="000000" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text39" Left="206.77" Width="79.76" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.QTD_ENTRADA]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="4" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text40" Left="286.52" Width="100.17" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.CUSTO_MEDIO_ENTRADA]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text41" Left="386.69" Width="100.17" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.VL_TOTAL_ENTRADA]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text42" Left="486.86" Width="80.14" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.QTD_SAIDA]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="4" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text43" Left="567" Width="100.17" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.CUSTO_MEDIO_SAIDA]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text44" Left="667.17" Width="99.79" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.VL_TOTAL_SAIDA]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text45" Left="766.96" Width="80.14" Height="12.85" Border.Lines="All" Text="[SqlDetalhe.QTD_ATUAL]&#13;&#10;" Format="Number" Format.UseLocale="true" Format.DecimalDigits="4" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <TextObject Name="Text46" Left="847.1" Width="100.17" Height="12.85" Border.Lines="All" Text="[[SqlDetalhe.QTD_ATUAL] * [SqlDetalhe.CUSTO_MEDIO_ATUAL]]" Format="Number" Format.UseLocale="true" Format.DecimalDigits="2" HorzAlign="Center" Font="Tahoma, 7pt"/>
      <DataHeaderBand Name="DataHeader1" Top="203.77" Width="1047.06" Height="25.7" RepeatOnEveryPage="true">
        <TextObject Name="Text22" Left="99.79" Width="106.97" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Lançamento" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text23" Left="206.77" Width="280.1" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Entrada" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text24" Left="486.86" Width="280.1" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Saída" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text25" Left="766.96" Width="280.48" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Saldo" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text26" Left="99.79" Top="12.85" Width="52.16" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Data" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text27" Left="151.96" Top="12.85" Width="54.81" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Número" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text28" Left="206.77" Top="12.85" Width="80.14" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Quantidade" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text29" Left="286.52" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Valor Unitário" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text30" Left="386.69" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Valor Total" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text31" Left="486.86" Top="12.85" Width="80.14" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Quantidade" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text32" Left="567" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Valor Unitário" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text33" Left="667.17" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Valor Total" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text34" Left="766.9" Top="12.85" Width="80.14" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Quantidade" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text35" Left="847.04" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Valor Total" HorzAlign="Center" Font="Tahoma, 7pt"/>
        <TextObject Name="Text36" Left="947.21" Top="12.85" Width="100.17" Height="12.85" Border.Lines="All" Fill.Color="ButtonFace" Text="Custo Médio" HorzAlign="Center" Font="Tahoma, 7pt"/>
      </DataHeaderBand>
      <DataFooterBand Name="DataFooter1" Top="247.72" Width="1047.06" Height="37.8">
        <LineObject Name="Line1" Left="99.5" Top="9.45" Width="947.27"/>
      </DataFooterBand>
    </DataBand>
    <inherited Name="BndRodape" Top="288.23">
      <inherited Name="TxtRodape"/>
      <inherited Name="TxtPaginacao">
        <Formats>
          <GeneralFormat/>
          <GeneralFormat/>
        </Formats>
      </inherited>
      <inherited Name="TxtEndereco">
        <Formats>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
          <GeneralFormat/>
        </Formats>
      </inherited>
    </inherited>
  </inherited>
</inherited>
