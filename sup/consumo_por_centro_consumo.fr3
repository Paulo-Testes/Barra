<?xml version="1.0" encoding="utf-8" standalone="no"?>
<inherited ParentReport="SupPaisagem" PreviewOptions.AllowEdit="False" PreviewOptions.Buttons="1535" ReportOptions.Name="Consumo por centro de consumo" ReportOptions.LastChange="45495,695891713" ScriptText.Text="procedure grpAlmoxarifadoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grpAlmoxarifado.Visible := &#60;AgruparAlmoxarifado&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure grpUnidadeAdmOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grpUnidadeAdm.Visible := &#60;AgruparUnidadeAdm&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure grfUnidadeAdmOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grfUnidadeAdm.Visible := &#60;AgruparUnidadeAdm&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure grfAlmoxarifadoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grfAlmoxarifado.Visible := &#60;AgruparAlmoxarifado&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure bndFiltroOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  bndFiltro.Visible := &#60;SupWeb&#62; = 0;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure bndFiltroSupWebOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  bndFiltroSupWeb.Visible := &#60;SupWeb&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure grpMaterialOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grpMaterial.Visible := &#60;AgruparMaterial&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure grfMaterialOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grfMaterial.Visible := &#60;AgruparMaterial&#62; = 1;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  if &#60;IdRelatorioFiltro&#62; &#62; 0 then&#13;&#10;    SqlConsumo.SQL.Text := StringReplace(SqlConsumo.SQL.Text, '/*FILTRO_MATERIAL*/', 'AND E.ID_MATERIAL          = S.ID_FILTRO');&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="SqlCliente" DataSetName="SqlCliente"/>
    <item DataSet="SqlUsuario" DataSetName="SqlUsuario"/>
    <item DataSet="SqlModulo" DataSetName="SqlModulo"/>
    <item DataSet="SqlEntidade" DataSetName="SqlEntidade"/>
    <item DataSet="SqlConsumo" DataSetName="SqlConsumo"/>
    <item DataSet="SqlCentroConsumo" DataSetName="SqlCentroConsumo"/>
    <item DataSet="SqlUnidadeAdm" DataSetName="SqlUnidadeAdm"/>
    <item DataSet="SqlGrupo" DataSetName="SqlGrupo"/>
    <item DataSet="SqlSubGrupo" DataSetName="SqlSubGrupo"/>
  </Datasets>
  <Variables>
    <item InheritedName=" Internas"/>
    <item InheritedName="IdModulo"/>
    <item InheritedName="Personalizado"/>
    <item InheritedName="Formato"/>
    <item InheritedName="CodigoRelatorio"/>
    <item InheritedName=" Disponiveis"/>
    <item InheritedName="IdEntidade"/>
    <item InheritedName="IdRelatorioFiltro"/>
    <item InheritedName="Competencia"/>
    <item InheritedName=" Utilizadas"/>
    <item InheritedName="IdUsuario"/>
    <item Name="DataInicial" Value="'01/01/2020'"/>
    <item Name="DataFinal" Value="'31/12/2020'"/>
    <item Name="Almoxarifado" Value="''"/>
    <item Name="UnidadeAdm" Value="''"/>
    <item Name="CentroConsumo" Value="''"/>
    <item Name="Material" Value="''"/>
    <item Name="AgruparAlmoxarifado" Value="1"/>
    <item Name="AgruparUnidadeAdm" Value="0"/>
    <item Name="IdUnidadeAdm" Value="-1"/>
    <item Name="IdCentroConsumo" Value="-1"/>
    <item Name="SupWeb" Value="0"/>
    <item Name="IdGrupo" Value="-1"/>
    <item Name="IdGrupoPai" Value="-1"/>
    <item Name="AgruparMaterial" Value="0"/>
  </Variables>
  <inherited Name="Data">
    <inherited Name="SqlCliente"/>
    <inherited Name="SqlUsuario"/>
    <inherited Name="SqlModulo"/>
    <inherited Name="SqlEntidade"/>
    <TfrxADOQuery Name="SqlConsumo" UserName="SqlConsumo" CloseDataSource="True" FieldAliases.Text="CD_ALMOXARIFADO=CD_ALMOXARIFADO&#13;&#10;DS_ALMOXARIFADO=DS_ALMOXARIFADO&#13;&#10;CD_UNIDADE_ADM=CD_UNIDADE_ADM&#13;&#10;DS_UNIDADE_ADM=DS_UNIDADE_ADM&#13;&#10;DS_CENTRO_CONSUMO=DS_CENTRO_CONSUMO&#13;&#10;CD_MATERIAL=CD_MATERIAL&#13;&#10;TP_MATERIAL=TP_MATERIAL&#13;&#10;CD_GRUPO=CD_GRUPO&#13;&#10;CD_SUBGRUPO=CD_SUBGRUPO&#13;&#10;DS_GRUPO=DS_GRUPO&#13;&#10;DS_SUBGRUPO=DS_SUBGRUPO&#13;&#10;DS_MATERIAL=DS_MATERIAL&#13;&#10;UN_MATERIAL=UN_MATERIAL&#13;&#10;MAX_ID_LANCAMENTO_IT=MAX_ID_LANCAMENTO_IT&#13;&#10;NOME_RAZAO=NOME_RAZAO&#13;&#10;NR_NF=NR_NF&#13;&#10;QTD_TOTAL=QTD_TOTAL&#13;&#10;VL_TOTAL=VL_TOTAL&#13;&#10;QTD_MEDIA=QTD_MEDIA&#13;&#10;VL_MEDIO=VL_MEDIO&#13;&#10;ULTIMA_QTD=ULTIMA_QTD&#13;&#10;ULTIMO_VALOR=ULTIMO_VALOR" BCDToCurrency="False" IgnoreDupParams="True" SQL.Text="SELECT XX.CD_ALMOXARIFADO&#13;&#10;     , XX.DS_ALMOXARIFADO&#13;&#10;     , XX.CD_UNIDADE_ADM&#13;&#10;     , XX.DS_UNIDADE_ADM&#13;&#10;     , XX.DS_CENTRO_CONSUMO&#13;&#10;     , XX.CD_MATERIAL&#13;&#10;     , XX.TP_MATERIAL&#13;&#10;     , XX.CD_GRUPO&#13;&#10;     , XX.CD_SUBGRUPO&#13;&#10;     , XX.DS_GRUPO&#13;&#10;     , XX.DS_SUBGRUPO&#13;&#10;     , XX.DS_MATERIAL&#13;&#10;     , XX.UN_MATERIAL&#13;&#10;     , XX.MAX_ID_LANCAMENTO_IT&#13;&#10;     , XX.NOME_RAZAO&#13;&#10;     , XX.NR_NF&#13;&#10;     , XX.QTD_TOTAL * -1 AS QTD_TOTAL                       &#13;&#10;     , XX.VL_TOTAL  * -1 AS VL_TOTAL                      &#13;&#10;     , CASE WHEN XX.DIAS = 0 THEN 0 ELSE (XX.QTD_TOTAL / XX.DIAS) * -1 END AS QTD_MEDIA&#13;&#10;     , CASE WHEN XX.DIAS = 0 THEN 0 ELSE (XX.VL_TOTAL  / XX.DIAS) * -1 END AS VL_MEDIO&#13;&#10;     , (SELECT A1.QTD      * -1 FROM SUP_LANCAMENTO_IT A1 WHERE A1.ID_LANCAMENTO_IT = MAX_ID_LANCAMENTO_IT) AS ULTIMA_QTD&#13;&#10;     , (SELECT A1.VL_TOTAL * -1 FROM SUP_LANCAMENTO_IT A1 WHERE A1.ID_LANCAMENTO_IT = MAX_ID_LANCAMENTO_IT) AS ULTIMO_VALOR&#13;&#10;  FROM (&#13;&#10;        SELECT X.CD_ALMOXARIFADO&#13;&#10;             , X.DS_ALMOXARIFADO&#13;&#10;             , C.CD_UNIDADE_ADM&#13;&#10;             , C.DS_UNIDADE_ADM&#13;&#10;             , D.DS_CENTRO_CONSUMO&#13;&#10;             , F.CD_MATERIAL&#13;&#10;             , F.TP_MATERIAL&#13;&#10;             , H.CD_GRUPO AS CD_GRUPO&#13;&#10;             , G.CD_GRUPO AS CD_SUBGRUPO&#13;&#10;             , H.DS_GRUPO AS DS_GRUPO&#13;&#10;             , G.DS_GRUPO AS DS_SUBGRUPO&#13;&#10;             , F.DS_MATERIAL&#13;&#10;             , F.UN_MATERIAL&#13;&#10;             , SP.NOME_RAZAO&#13;&#10;             , SPN.NR_NF&#13;&#10;             , CAST(UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL) - UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL) + 1 AS DOUBLE PRECISION) AS DIAS&#13;&#10;             , MAX(E.ID_LANCAMENTO_IT) AS MAX_ID_LANCAMENTO_IT&#13;&#10;             , SUM(E.QTD) +      COALESCE(SUM((SELECT COALESCE(SUM(B1.QTD), 0)&#13;&#10;                                                 FROM SUP_LANCAMENTO_ENTRADA A1&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO       C1 ON A1.ID_LANCAMENTO = C1.ID_LANCAMENTO&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO_IT    B1 ON A1.ID_LANCAMENTO = B1.ID_LANCAMENTO&#13;&#10;                                                WHERE A1.ID_LANCAMENTO_SAIDA = A.ID_LANCAMENTO&#13;&#10;                                                  AND A1.TP_ENTRADA     = 5 /*TP_ENTRADA_ESTORNO*/&#13;&#10;                                                  AND B1.ID_MATERIAL    = F.ID_MATERIAL&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#62;= UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL)&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#60;= UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL      ))), 0) AS QTD_TOTAL&#13;&#10;             , SUM(E.VL_TOTAL) + COALESCE(SUM((SELECT COALESCE(SUM(B1.VL_TOTAL), 0)&#13;&#10;                                                 FROM SUP_LANCAMENTO_ENTRADA A1&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO      C1 ON A1.ID_LANCAMENTO = C1.ID_LANCAMENTO&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO_IT   B1 ON A1.ID_LANCAMENTO = B1.ID_LANCAMENTO&#13;&#10;                                                WHERE A1.ID_LANCAMENTO_SAIDA = A.ID_LANCAMENTO&#13;&#10;                                                  AND A1.TP_ENTRADA     = 5 /*TP_ENTRADA_ESTORNO*/&#13;&#10;                                                  AND B1.ID_MATERIAL    = F.ID_MATERIAL&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#62;= UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL)&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#60;= UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL      ))), 0) AS VL_TOTAL&#13;&#10;          FROM (&#13;&#10;                SELECT SEQ.ID_SEQUENCIA AS FILTRAR&#13;&#10;                  FROM SIS_SEQUENCIA SEQ&#13;&#10;                 WHERE SEQ.ID_SEQUENCIA = CASE WHEN 0 = :SUP_WEB THEN 1 ELSE -1 END&#13;&#10;               ) S&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_SAIDA       B ON 1                      = S.FILTRAR&#13;&#10;               LEFT JOIN SUP_LANCAMENTO             A ON A.ID_LANCAMENTO        = B.ID_LANCAMENTO&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_IT          E ON E.ID_LANCAMENTO        = A.ID_LANCAMENTO&#13;&#10;&#13;&#10;               LEFT JOIN SUP_ALMOXARIFADO           X ON X.ID_ALMOXARIFADO      = A.ID_ALMOXARIFADO&#13;&#10;               LEFT JOIN SUP_CENTRO_CONSUMO         D ON D.ID_CENTRO_CONSUMO    = B.ID_CENTRO_CONSUMO&#13;&#10;               LEFT JOIN SUP_UNIDADE_ADM            C ON C.ID_UNIDADE_ADM       = D.ID_UNIDADE_ADM&#13;&#10;               LEFT JOIN SUP_MATERIAL               F ON E.ID_MATERIAL          = F.ID_MATERIAL&#13;&#10;               LEFT JOIN SUP_GRUPO                  G ON G.ID_GRUPO             = F.ID_GRUPO&#13;&#10;               LEFT JOIN SUP_GRUPO                  H ON H.ID_GRUPO             = G.ID_GRUPO_PAI&#13;&#10;&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_ENTRADA   SLE ON SLE.ID_LANCAMENTO      = B.ID_LANCAMENTO_ENTRADA&#13;&#10;                                                     AND B.TP_SAIDA             = 8&#13;&#10;               LEFT JOIN SIS_PESSOA                SP ON SP.ID_PESSOA           = SLE.ID_FORNECEDOR&#13;&#10;               LEFT JOIN SIS_PESSOA_NF            SPN ON SPN.ID_PESSOA_NF       = SLE.ID_DOC_FISCAL&#13;&#10;         WHERE B.ID_CENTRO_CONSUMO IS NOT NULL                                                           &#13;&#10;           AND A.ID_ENTIDADE    = :ID_ENTIDADE      &#13;&#10;           AND A.DT_LANCAMENTO &#62;= UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL)&#13;&#10;           AND A.DT_LANCAMENTO &#60;= UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL      )&#13;&#10;&#13;&#10;           /*FILTRO ALMOXARIFADO*/&#13;&#10;           AND ( X.CD_ALMOXARIFADO = CAST(CAST('0' AS VARCHAR(1)) || TRIM(UDF_DIGITS(CAST(:ALMOXARIFADO AS VARCHAR(255)))) AS INTEGER) OR&#13;&#10;                 UNACCENT(X.DS_ALMOXARIFADO) LIKE UNACCENT('%' || CAST(:ALMOXARIFADO AS VARCHAR(255)) || '%')                           )&#13;&#10;&#13;&#10;           /*FILTRO UNIDADE ADM*/&#13;&#10;           AND ( C.CD_UNIDADE_ADM = CAST(CAST('0' AS VARCHAR(1)) || TRIM(UDF_DIGITS(CAST(:UNIDADE_ADM AS VARCHAR(255)))) AS INTEGER) OR&#13;&#10;                 UNACCENT(C.DS_UNIDADE_ADM)  LIKE UNACCENT('%' || CAST(:UNIDADE_ADM AS VARCHAR(255)) || '%')                          )&#13;&#10;&#13;&#10;           /*FILTRO CENTRO CONSUMO*/&#13;&#10;           AND ( D.CD_CENTRO_CONSUMO = CAST(CAST('0' AS VARCHAR(1)) || TRIM(UDF_DIGITS(CAST(:CENTRO_CONSUMO AS VARCHAR(255)))) AS INTEGER) OR&#13;&#10;                 UNACCENT(D.DS_CENTRO_CONSUMO) LIKE UNACCENT('%' || CAST(:CENTRO_CONSUMO AS VARCHAR(255)) || '%')                           )&#13;&#10;&#13;&#10;           /*FILTRO MATERIAL*/&#13;&#10;           AND ( F.CD_MATERIAL = CAST(CAST('0' AS VARCHAR(1)) || TRIM(UDF_DIGITS(CAST(:MATERIAL AS VARCHAR(255)))) AS INTEGER) OR&#13;&#10;                 UNACCENT(F.DS_MATERIAL) LIKE UNACCENT('%' || CAST(:MATERIAL AS VARCHAR(255)) || '%')                         OR&#13;&#10;                 G.CD_GRUPO    = CAST(CAST('0' AS VARCHAR(1)) || TRIM(UDF_DIGITS(CAST(:MATERIAL AS VARCHAR(255)))) AS INTEGER) OR&#13;&#10;                 UNACCENT(G.DS_GRUPO)    LIKE UNACCENT('%' || CAST(:MATERIAL AS VARCHAR(255)) || '%')                         OR&#13;&#10;                 H.CD_GRUPO    = CAST(CAST('0' AS VARCHAR(1)) || TRIM(UDF_DIGITS(CAST(:MATERIAL AS VARCHAR(255)))) AS INTEGER) OR&#13;&#10;                 UNACCENT(H.DS_GRUPO)    LIKE UNACCENT('%' || CAST(:MATERIAL AS VARCHAR(255)) || '%')                           )&#13;&#10;&#13;&#10;         GROUP BY&#13;&#10;               X.CD_ALMOXARIFADO&#13;&#10;             , X.DS_ALMOXARIFADO &#13;&#10;             , C.CD_UNIDADE_ADM&#13;&#10;             , C.DS_UNIDADE_ADM&#13;&#10;             , D.DS_CENTRO_CONSUMO&#13;&#10;             , F.CD_MATERIAL&#13;&#10;             , F.TP_MATERIAL&#13;&#10;             , H.CD_GRUPO&#13;&#10;             , G.CD_GRUPO&#13;&#10;             , F.DS_MATERIAL&#13;&#10;             , F.CD_MATERIAL&#13;&#10;             , F.UN_MATERIAL&#13;&#10;             , F.ID_MATERIAL&#13;&#10;             , H.DS_GRUPO&#13;&#10;             , G.DS_GRUPO&#13;&#10;             , SP.NOME_RAZAO&#13;&#10;             , SPN.NR_NF&#13;&#10;&#13;&#10;         UNION ALL&#13;&#10;&#13;&#10;        SELECT X.CD_ALMOXARIFADO&#13;&#10;             , X.DS_ALMOXARIFADO&#13;&#10;             , C.CD_UNIDADE_ADM&#13;&#10;             , C.DS_UNIDADE_ADM&#13;&#10;             , D.DS_CENTRO_CONSUMO&#13;&#10;             , F.CD_MATERIAL&#13;&#10;             , F.TP_MATERIAL&#13;&#10;             , H.CD_GRUPO AS CD_GRUPO&#13;&#10;             , G.CD_GRUPO AS CD_SUBGRUPO&#13;&#10;             , H.DS_GRUPO AS DS_GRUPO&#13;&#10;             , G.DS_GRUPO AS DS_SUBGRUPO&#13;&#10;             , F.DS_MATERIAL&#13;&#10;             , F.UN_MATERIAL&#13;&#10;             , SP.NOME_RAZAO&#13;&#10;             , SPN.NR_NF&#13;&#10;             , CAST(UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL) - UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL) + 1 AS DOUBLE PRECISION) AS DIAS&#13;&#10;             , MAX(E.ID_LANCAMENTO_IT) AS MAX_ID_LANCAMENTO_IT&#13;&#10;             , SUM(E.QTD) +      COALESCE(SUM((SELECT COALESCE(SUM(B1.QTD), 0)&#13;&#10;                                                 FROM SUP_LANCAMENTO_ENTRADA A1&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO       C1 ON A1.ID_LANCAMENTO = C1.ID_LANCAMENTO&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO_IT    B1 ON A1.ID_LANCAMENTO = B1.ID_LANCAMENTO&#13;&#10;                                                WHERE A1.ID_LANCAMENTO_SAIDA = A.ID_LANCAMENTO&#13;&#10;                                                  AND A1.TP_ENTRADA     = 5 /*TP_ENTRADA_ESTORNO*/&#13;&#10;                                                  AND B1.ID_MATERIAL    = F.ID_MATERIAL&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#62;= UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL)&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#60;= UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL      ))), 0) AS QTD_TOTAL&#13;&#10;             , SUM(E.VL_TOTAL) + COALESCE(SUM((SELECT COALESCE(SUM(B1.VL_TOTAL), 0)&#13;&#10;                                                 FROM SUP_LANCAMENTO_ENTRADA A1&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO      C1 ON A1.ID_LANCAMENTO = C1.ID_LANCAMENTO&#13;&#10;                                                      LEFT JOIN SUP_LANCAMENTO_IT   B1 ON A1.ID_LANCAMENTO = B1.ID_LANCAMENTO&#13;&#10;                                                WHERE A1.ID_LANCAMENTO_SAIDA = A.ID_LANCAMENTO&#13;&#10;                                                  AND A1.TP_ENTRADA     = 5 /*TP_ENTRADA_ESTORNO*/&#13;&#10;                                                  AND B1.ID_MATERIAL    = F.ID_MATERIAL&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#62;= UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL)&#13;&#10;                                                  AND C1.DT_LANCAMENTO &#60;= UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL      ))), 0) AS VL_TOTAL&#13;&#10;          FROM (&#13;&#10;                SELECT CAST(:SUP_WEB AS INTEGER) AS FILTRAR&#13;&#10;                     , SRF.ID_FILTRO                                                                                                                                                               &#13;&#10;                  FROM SIS_SEQUENCIA SEQ&#13;&#10;                       LEFT JOIN SIS_RELATORIO_FILTRO SRF ON SRF.ID_RELATORIO_FILTRO = :ID_RELATORIO_FILTRO&#13;&#10;                 WHERE SEQ.ID_SEQUENCIA = 1&#13;&#10;               ) S&#13;&#10;               RIGHT JOIN SUP_LANCAMENTO            A ON A.ID_ENTIDADE          = :ID_ENTIDADE                                                                                                                                  &#13;&#10;                                                     AND A.CP_ANO              &#60;= :ANO_FINAL&#13;&#10;                                                     AND 1                      = S.FILTRAR&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_SAIDA       B ON A.ID_LANCAMENTO        = B.ID_LANCAMENTO&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_IT          E ON E.ID_LANCAMENTO        = A.ID_LANCAMENTO&#13;&#10;                                                     /*FILTRO_MATERIAL*/ &#13;&#10;               LEFT JOIN SUP_ALMOXARIFADO           X ON X.ID_ALMOXARIFADO      = A.ID_ALMOXARIFADO&#13;&#10;               LEFT JOIN SUP_CENTRO_CONSUMO         D ON D.ID_CENTRO_CONSUMO    = B.ID_CENTRO_CONSUMO&#13;&#10;               LEFT JOIN SUP_UNIDADE_ADM            C ON C.ID_UNIDADE_ADM       = D.ID_UNIDADE_ADM&#13;&#10;               LEFT JOIN SUP_MATERIAL               F ON E.ID_MATERIAL          = F.ID_MATERIAL&#13;&#10;               LEFT JOIN SUP_GRUPO                  G ON G.ID_GRUPO             = F.ID_GRUPO&#13;&#10;               LEFT JOIN SUP_GRUPO                  H ON H.ID_GRUPO             = G.ID_GRUPO_PAI&#13;&#10;&#13;&#10;               LEFT JOIN SUP_LANCAMENTO_ENTRADA   SLE ON SLE.ID_LANCAMENTO      = B.ID_LANCAMENTO_ENTRADA&#13;&#10;                                                     AND B.TP_SAIDA             = 8&#13;&#10;               LEFT JOIN SIS_PESSOA                SP ON SP.ID_PESSOA           = SLE.ID_FORNECEDOR&#13;&#10;               LEFT JOIN SIS_PESSOA_NF            SPN ON SPN.ID_PESSOA_NF       = SLE.ID_DOC_FISCAL&#13;&#10;         WHERE S.FILTRAR        = 1&#13;&#10;           AND A.ID_ENTIDADE    = :ID_ENTIDADE                    &#13;&#10;           AND A.CP_ANO        &#60;= :ANO_FINAL&#13;&#10;           AND A.DT_LANCAMENTO &#62;= UDF_ENCDATE(:ANO_INICIAL, :MES_INICIAL, :DIA_INICIAL)&#13;&#10;           AND A.DT_LANCAMENTO &#60;= UDF_ENCDATE(:ANO_FINAL, :MES_FINAL, :DIA_FINAL      )&#13;&#10;           AND B.ID_CENTRO_CONSUMO IS NOT NULL&#13;&#10;           AND ( B.ID_CENTRO_CONSUMO = CAST(:ID_CENTRO_CONSUMO AS INTEGER) OR -1 = CAST(:ID_CENTRO_CONSUMO AS INTEGER) )&#13;&#10;           AND ( D.ID_UNIDADE_ADM    = CAST(:ID_UNIDADE_ADM    AS INTEGER) OR -1 = CAST(:ID_UNIDADE_ADM    AS INTEGER) )&#13;&#10;           AND (F.ID_GRUPO = :ID_GRUPO OR -1 = :ID_GRUPO)&#13;&#10;           AND (G.ID_GRUPO_PAI = :ID_GRUPO_PAI OR -1 = :ID_GRUPO_PAI)               &#13;&#10;               &#13;&#10;           /*FILTRO_MATERIAL*/&#13;&#10;&#13;&#10;         GROUP BY&#13;&#10;               X.CD_ALMOXARIFADO&#13;&#10;             , X.DS_ALMOXARIFADO &#13;&#10;             , C.CD_UNIDADE_ADM&#13;&#10;             , C.DS_UNIDADE_ADM&#13;&#10;             , D.DS_CENTRO_CONSUMO&#13;&#10;             , F.DS_MATERIAL&#13;&#10;             , F.TP_MATERIAL&#13;&#10;             , H.CD_GRUPO&#13;&#10;             , G.CD_GRUPO&#13;&#10;             , F.CD_MATERIAL               &#13;&#10;             , F.UN_MATERIAL&#13;&#10;             , F.ID_MATERIAL&#13;&#10;               &#13;&#10;             , H.DS_GRUPO&#13;&#10;             , G.DS_GRUPO&#13;&#10;             , SP.NOME_RAZAO&#13;&#10;             , SPN.NR_NF&#13;&#10;&#13;&#10;       ) XX&#13;&#10; ORDER BY&#13;&#10;       CASE WHEN 1 = :AGRUPAR_ALMOXARIFADO THEN XX.DS_ALMOXARIFADO ELSE '' END&#13;&#10;     , CASE WHEN 1 = :AGRUPAR_UNIDADE_ADM  THEN XX.DS_UNIDADE_ADM  ELSE '' END&#13;&#10;     , XX.DS_CENTRO_CONSUMO&#13;&#10;     , XX.DS_MATERIAL&#13;&#10;     , XX.CD_GRUPO&#13;&#10;     , XX.CD_GRUPO     " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C656674027C0470546F7003BA000A506172616D657465727301010654204E616D653D22414E4F5F46494E414C222044617461547970653D226674496E7465676572222045787072657373696F6E3D22457874726163745965617228262336303B4461746146696E616C262336323B292200010655204E616D653D224D45535F46494E414C222044617461547970653D226674496E7465676572222045787072657373696F6E3D22457874726163744D6F6E746828262336303B4461746146696E616C262336323B292200010653204E616D653D224449415F46494E414C222044617461547970653D226674496E7465676572222045787072657373696F6E3D224578747261637444617928262336303B4461746146696E616C262336323B292200010658204E616D653D22414E4F5F494E494349414C222044617461547970653D226674496E7465676572222045787072657373696F6E3D22457874726163745965617228262336303B44617461496E696369616C262336323B292200010659204E616D653D224D45535F494E494349414C222044617461547970653D226674496E7465676572222045787072657373696F6E3D22457874726163744D6F6E746828262336303B44617461496E696369616C262336323B292200010657204E616D653D224449415F494E494349414C222044617461547970653D226674496E7465676572222045787072657373696F6E3D224578747261637444617928262336303B44617461496E696369616C262336323B292200010642204E616D653D225355505F574542222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B537570576562262336323B220001064A204E616D653D2249445F454E544944414445222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964456E746964616465262336323B220001064C204E616D653D22414C4D4F584152494641444F222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B416C6D6F786172696661646F262336323B2200010649204E616D653D22554E49444144455F41444D222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B556E696461646541646D262336323B220001064F204E616D653D2243454E54524F5F434F4E53554D4F222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B43656E74726F436F6E73756D6F262336323B2200010644204E616D653D224D4154455249414C222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B4D6174657269616C262336323B2200010659204E616D653D2249445F52454C41544F52494F5F46494C54524F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B496452656C61746F72696F46696C74726F262336323B2200010655204E616D653D2249445F43454E54524F5F434F4E53554D4F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B496443656E74726F436F6E73756D6F262336323B220001064F204E616D653D2249445F554E49444144455F41444D222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964556E696461646541646D262336323B2200010644204E616D653D2249445F475255504F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F262336323B220001064B204E616D653D2249445F475255504F5F504149222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F506169262336323B220001065C204E616D653D22414752555041525F414C4D4F584152494641444F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B41677275706172416C6D6F786172696661646F262336323B2200010659204E616D653D22414752555041525F554E49444144455F41444D222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B41677275706172556E696461646541646D262336323B220000"/>
    <TfrxADOQuery Name="SqlCentroConsumo" UserName="SqlCentroConsumo" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.CD_CENTRO_CONSUMO&#13;&#10;     , TRIM(A.DS_CENTRO_CONSUMO) AS DS_CENTRO_CONSUMO&#13;&#10;  FROM SUP_CENTRO_CONSUMO A&#13;&#10; WHERE A.ID_CENTRO_CONSUMO = CAST(:ID_CENTRO_CONSUMO AS INTEGER)                            " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C65667403CC000470546F7003BA000A506172616D657465727301010654204E616D653D2249445F43454E54524F5F434F4E53554D4F222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B496443656E74726F436F6E73756D6F262336323B220000"/>
    <TfrxADOQuery Name="SqlUnidadeAdm" UserName="SqlUnidadeAdm" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.CD_UNIDADE_ADM&#13;&#10;     , TRIM(A.DS_UNIDADE_ADM) AS DS_UNIDADE_ADM&#13;&#10;  FROM SUP_UNIDADE_ADM A&#13;&#10; WHERE A.ID_UNIDADE_ADM = CAST(:ID_UNIDADE_ADM AS INTEGER)                               " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C65667403CC000470546F7003F9000A506172616D65746572730101064E204E616D653D2249445F554E49444144455F41444D222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B4964556E696461646541646D262336323B220000"/>
    <TfrxADOQuery Name="SqlGrupo" UserName="SqlGrupo" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.CD_GRUPO&#13;&#10;     , TRIM(A.DS_GRUPO) AS DS_GRUPO              &#13;&#10;  FROM SUP_GRUPO A&#13;&#10; WHERE A.ID_GRUPO = :ID_GRUPO_PAI&#13;&#10;  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740338010470546F7003B8000A506172616D65746572730101064B204E616D653D2249445F475255504F5F504149222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F506169262336323B220000"/>
    <TfrxADOQuery Name="SqlSubGrupo" UserName="SqlSubGrupo" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.CD_GRUPO AS CD_SUBGRUPO&#13;&#10;     , TRIM(A.DS_GRUPO) AS DS_SUBGRUPO&#13;&#10;  FROM SUP_GRUPO A&#13;&#10; WHERE A.ID_GRUPO = :ID_GRUPO  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740338010470546F7003FC000A506172616D657465727301010644204E616D653D2249445F475255504F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F262336323B220000"/>
  </inherited>
  <inherited Name="Page1" PaperSize="9" Frame.Color="16777215">
    <inherited Name="bndCabecalho" Child="bndFiltro">
      <inherited Name="Logo"/>
      <inherited Name="Brasao"/>
      <inherited Name="TxtNomeCliente"/>
      <inherited Name="TxtTitulo1"/>
      <inherited Name="TxtTitulo2"/>
      <inherited Name="TxtTituloRelatorio" Text="Consumo por centro de consumo"/>
      <inherited Name="Line1"/>
      <inherited Name="TxtData"/>
      <inherited Name="TxtHora"/>
      <inherited Name="TxtCompetencia"/>
    </inherited>
    <inherited Name="BndRodape" Top="721,89023">
      <inherited Name="Line2"/>
      <inherited Name="TxtRodape"/>
      <inherited Name="TxtPaginacao"/>
      <inherited Name="TxtDataHora"/>
    </inherited>
    <TfrxGroupHeader Name="grpAlmoxarifado" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="21" Left="0" Top="279,68522" Width="1046,92981" OnBeforePrint="grpAlmoxarifadoOnBeforePrint" Condition="SqlConsumo.&#34;CD_ALMOXARIFADO&#34;" ReprintOnNewPage="True" StartNewPage="True" Stretched="True">
      <TfrxMemoView Name="SqlConsumoDS_ALMOXARIFADO" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="20" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="11" Frame.LeftLine.Color="12500670" Frame.RightLine.Color="12500670" Fill.BackColor="12500670" ParentFont="False" VAlign="vaBottom" Text="Almoxarifado: &#60;b&#62;[SqlConsumo.&#34;CD_ALMOXARIFADO&#34;] - [SqlConsumo.&#34;DS_ALMOXARIFADO&#34;]&#60;/b&#62;">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="grpUnidadeAdm" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="16" Left="0" Top="325,03958" Width="1046,92981" OnBeforePrint="grpUnidadeAdmOnBeforePrint" Condition="SqlConsumo.&#34;CD_UNIDADE_ADM&#34;" Stretched="True">
      <TfrxMemoView Name="SqlConsumoDS_UNIDADE_ADM" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="3" Frame.LeftLine.Color="14474460" Frame.RightLine.Color="14474460" Fill.BackColor="14474460" ParentFont="False" VAlign="vaBottom" Text="Unidade Adm.: &#60;b&#62;[SqlConsumo.&#34;CD_UNIDADE_ADM&#34;] - [SqlConsumo.&#34;DS_UNIDADE_ADM&#34;]&#60;/b&#62;"/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="grpCentroConsumo" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="16" Left="0" Top="362,83488" Width="1046,92981" Condition="SqlConsumo.&#34;DS_CENTRO_CONSUMO&#34;" Stretched="True">
      <TfrxMemoView Name="SqlConsumoDS_CENTRO_CONSUMO" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="3" Frame.LeftLine.Color="15790320" Frame.RightLine.Color="15790320" Fill.BackColor="15790320" ParentFont="False" VAlign="vaBottom" Text="Centro de Consumo: &#60;b&#62;[SqlConsumo.&#34;DS_CENTRO_CONSUMO&#34;]&#60;/b&#62;"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="bndConsumo" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="12" Left="0" Top="438,42548" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="SqlConsumo" DataSetName="SqlConsumo" RowCount="0" Stretched="True">
      <TfrxMemoView Name="SqlConsumoCD_MATERIAL" IndexTag="1" Align="baLeft" AllowVectorExport="True" Left="0" Top="0" Width="50" Height="12" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="536870911" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[FormatFloat('00000000', &#60;SqlConsumo.&#34;CD_MATERIAL&#34;&#62;)]"/>
      <TfrxMemoView Name="SqlConsumoDS_MATERIAL" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="50" Top="0" Width="396,92981" Height="12" StretchMode="smMaxHeight" DataField="DS_MATERIAL" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;DS_MATERIAL&#34;]"/>
      <TfrxMemoView Name="SqlConsumoULTIMO_VALOR" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="976,92981" Top="0" Width="70" Height="12" DataField="ULTIMO_VALOR" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;ULTIMO_VALOR&#34;]"/>
      <TfrxMemoView Name="SqlConsumoULTIMA_QTD" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="906,92981" Top="0" Width="70" Height="12" DataField="ULTIMA_QTD" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;ULTIMA_QTD&#34;]"/>
      <TfrxMemoView Name="SqlConsumoVL_MEDIO_MES" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="836,92981" Top="0" Width="70" Height="12" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[&#60;SqlConsumo.&#34;VL_MEDIO&#34;&#62; * 30]"/>
      <TfrxMemoView Name="SqlConsumoQTD_MEDIA_MES" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="766,92981" Top="0" Width="70" Height="12" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[&#60;SqlConsumo.&#34;QTD_MEDIA&#34;&#62; * 30]"/>
      <TfrxMemoView Name="SqlConsumoVL_MEDIO" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="696,92981" Top="0" Width="70" Height="12" DataField="VL_MEDIO" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;VL_MEDIO&#34;]"/>
      <TfrxMemoView Name="SqlConsumoQTD_MEDIA" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="0" Width="70" Height="12" DataField="QTD_MEDIA" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;QTD_MEDIA&#34;]"/>
      <TfrxMemoView Name="SqlConsumoVL_TOTAL" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="556,92981" Top="0" Width="70" Height="12" DataField="VL_TOTAL" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;VL_TOTAL&#34;]"/>
      <TfrxMemoView Name="SqlConsumoQTD_TOTAL" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="0" Width="70" Height="12" DataField="QTD_TOTAL" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;QTD_TOTAL&#34;]"/>
      <TfrxMemoView Name="SqlConsumoUN_MATERIAL" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="446,92981" Top="0" Width="40" Height="12" DataField="UN_MATERIAL" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Color="15790320" Frame.Typ="3" HAlign="haCenter" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SqlConsumo.&#34;UN_MATERIAL&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="grpCabecalho" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="31" Left="0" Top="226,7718" Width="1046,92981" Condition="SqlCliente.&#34;NOME&#34;" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="486,92981" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Material"/>
      <TfrxMemoView Name="Memo2" Align="baRight" AllowVectorExport="True" Left="976,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Valor Total"/>
      <TfrxMemoView Name="Memo3" Align="baRight" AllowVectorExport="True" Left="906,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Quantidade"/>
      <TfrxMemoView Name="Memo4" Align="baRight" AllowVectorExport="True" Left="836,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Valor Total"/>
      <TfrxMemoView Name="Memo5" Align="baRight" AllowVectorExport="True" Left="766,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Quantidade"/>
      <TfrxMemoView Name="Memo6" Align="baRight" AllowVectorExport="True" Left="696,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Valor Total"/>
      <TfrxMemoView Name="Memo7" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Quantidade"/>
      <TfrxMemoView Name="Memo8" Align="baRight" AllowVectorExport="True" Left="556,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Valor Total"/>
      <TfrxMemoView Name="Memo9" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="15" Width="70" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Quantidade"/>
      <TfrxMemoView Name="Memo10" Align="baRight" AllowVectorExport="True" Left="906,92981" Top="0" Width="140" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Última Saída"/>
      <TfrxMemoView Name="Memo11" Align="baRight" AllowVectorExport="True" Left="766,92981" Top="0" Width="140" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Consumo Médio Mensal"/>
      <TfrxMemoView Name="Memo12" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="0" Width="140" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Consumo Médio Diário"/>
      <TfrxMemoView Name="Memo13" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="0" Width="140" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Total Consumido"/>
      <TfrxMemoView Name="Memo14" Align="baLeft" AllowVectorExport="True" Left="0" Top="15" Width="50" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Código"/>
      <TfrxMemoView Name="Memo16" Align="baWidth" AllowVectorExport="True" Left="50" Top="15" Width="396,92981" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Descrição"/>
      <TfrxMemoView Name="Memo17" Align="baRight" AllowVectorExport="True" Left="446,92981" Top="15" Width="40" Height="15" Font.Charset="1" Font.Color="16777215" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Unid."/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="grfCentroConsumo" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="30" Left="0" Top="525,35467" Width="1046,92981" Stretched="True">
      <TfrxMemoView Name="Memo18" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="486,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="1" Frame.LeftLine.Color="15790320" Frame.RightLine.Color="15790320" Fill.BackColor="15790320" ParentFont="False" VAlign="vaCenter" Text="Total do Centro de Consumo: &#60;b&#62;[SqlConsumo.&#34;DS_CENTRO_CONSUMO&#34;]&#60;/b&#62;"/>
      <TfrxMemoView Name="Memo19" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="0" Width="420" Height="16" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="2" Frame.LeftLine.Color="15790320" Frame.RightLine.Color="15790320" Fill.BackColor="15790320" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo20" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="0" Width="140" Height="16" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="3" Fill.BackColor="15790320" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SUM(&#60;SqlConsumo.&#34;VL_TOTAL&#34;&#62;,bndConsumo)]"/>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="grfUnidadeAdm" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="30" Left="0" Top="578,26809" Width="1046,92981" OnBeforePrint="grfUnidadeAdmOnBeforePrint" Stretched="True">
      <TfrxMemoView Name="Memo22" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="0" Width="420" Height="16" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="2" Frame.LeftLine.Color="15790320" Frame.RightLine.Color="15790320" Fill.BackColor="14474460" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo23" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="0" Width="140" Height="16" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="3" Fill.BackColor="14474460" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SUM(&#60;SqlConsumo.&#34;VL_TOTAL&#34;&#62;,bndConsumo)]"/>
      <TfrxMemoView Name="Memo21" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="486,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="3" Frame.LeftLine.Color="14474460" Frame.RightLine.Color="14474460" Fill.BackColor="14474460" ParentFont="False" VAlign="vaCenter" Text="Total da Unidade Adm.: &#60;b&#62;[SqlConsumo.&#34;CD_UNIDADE_ADM&#34;] - [SqlConsumo.&#34;DS_UNIDADE_ADM&#34;]&#60;/b&#62;">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxGroupFooter>
    <TfrxGroupFooter Name="grfAlmoxarifado" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="30" Left="0" Top="631,18151" Width="1046,92981" OnBeforePrint="grfAlmoxarifadoOnBeforePrint" Stretched="True">
      <TfrxMemoView Name="Memo24" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="0" Width="420" Height="16" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="2" Frame.LeftLine.Color="15790320" Frame.RightLine.Color="15790320" Fill.BackColor="12500670" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo25" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="0" Width="140" Height="16" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="3" Fill.BackColor="12500670" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SUM(&#60;SqlConsumo.&#34;VL_TOTAL&#34;&#62;,bndConsumo)]"/>
      <TfrxMemoView Name="Memo26" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="486,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="3" Frame.LeftLine.Color="12500670" Frame.RightLine.Color="12500670" Fill.BackColor="12500670" ParentFont="False" VAlign="vaCenter" Text="Total do Almoxarifado: &#60;b&#62;[SqlConsumo.&#34;CD_ALMOXARIFADO&#34;] - [SqlConsumo.&#34;DS_ALMOXARIFADO&#34;]&#60;/b&#62;">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxGroupFooter>
    <TfrxChild Name="bndFiltro" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="8" Height="15" Left="0" Top="113,3859" Width="1046,92981" OnBeforePrint="bndFiltroOnBeforePrint" Child="bndFiltroSupWeb" PrintChildIfInvisible="True" Stretched="True" ToNRows="0" ToNRowsMode="rmCount">
      <TfrxMemoView Name="TxtPeriodo" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="15" StretchMode="smMaxHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="Período entre &#60;b&#62;[DataInicial]&#60;/b&#62; e &#60;b&#62;[DataFinal]&#60;/b&#62;[IIF(Trim(&#60;Almoxarifado&#62;) = '', '', ' | Almoxarifado contenha &#34;' + &#60;Almoxarifado&#62; + '&#34;')][IIF(Trim(&#60;UnidadeAdm&#62;) = '', '', ' | Unidade Adm. contenha &#34;' + &#60;UnidadeAdm&#62; + '&#34;')][IIF(Trim(&#60;CentroConsumo&#62;) = '', '', ' | Centro de Consumo contenha &#34;' + &#60;CentroConsumo&#62; + '&#34;')][IIF(Trim(&#60;Material&#62;) = '', '', ' | Material, Grupo ou SubGrupo contenha &#34;' + &#60;Material&#62; + '&#34;')]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxChild>
    <TfrxChild Name="bndFiltroSupWeb" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="8" Height="15" Left="0" Top="151,1812" Width="1046,92981" OnBeforePrint="bndFiltroSupWebOnBeforePrint" PrintChildIfInvisible="True" Stretched="True" ToNRows="0" ToNRowsMode="rmCount">
      <TfrxMemoView Name="Memo27" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="15" StretchMode="smMaxHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="Período entre &#60;b&#62;[DataInicial]&#60;/b&#62; e &#60;b&#62;[DataFinal]&#60;/b&#62;[IIF(&#60;IdUnidadeAdm&#62; &#62; 0, ' | Unidade Adm.: &#60;b&#62;' + VarToStr(&#60;SqlUnidadeAdm.&#34;CD_UNIDADE_ADM&#34;&#62;) + ' - ' + &#60;SqlUnidadeAdm.&#34;DS_UNIDADE_ADM&#34;&#62; + '&#60;/b&#62;', '')][IIF(&#60;IdCentroConsumo&#62; &#62; 0, ' | Centro de Consumo: &#60;b&#62;' + VarToStr(&#60;SqlCentroConsumo.&#34;CD_CENTRO_CONSUMO&#34;&#62;) + ' - ' + &#60;SqlCentroConsumo.&#34;DS_CENTRO_CONSUMO&#34;&#62; + '&#60;/b&#62;', '')][IIF(&#60;IdGrupoPai&#62; &#60;&#62; -1, Format(' | Grupo: &#60;b&#62;%d - %s&#60;/b&#62;', [&#60;SqlGrupo.&#34;CD_GRUPO&#34;&#62;, &#60;SqlGrupo.&#34;DS_GRUPO&#34;&#62;]), '')][IIF(&#60;IdGrupo&#62; &#60;&#62; -1, Format(' | Subgrupo: &#60;b&#62;%d - %s&#60;/b&#62;', [&#60;SqlSubgrupo.&#34;CD_SUBGRUPO&#34;&#62;, &#60;SqlSubgrupo.&#34;DS_SUBGRUPO&#34;&#62;]), '')]">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxChild>
    <TfrxGroupHeader Name="grpMaterial" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="15,87401575" Left="0" Top="400,63018" Width="1046,92981" OnBeforePrint="grpMaterialOnBeforePrint" Condition="SqlConsumo.&#34;CD_MATERIAL&#34;" Stretched="True">
      <TfrxMemoView Name="Memo29" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="3" Frame.LeftLine.Color="14474460" Frame.RightLine.Color="14474460" Fill.BackColor="14474460" ParentFont="False" VAlign="vaBottom" Text="Material.: &#60;b&#62;[SqlConsumo.&#34;CD_MATERIAL&#34;] - [SqlConsumo.&#34;DS_MATERIAL&#34;]&#60;/b&#62;">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="grfMaterial" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="29,85826772" Left="0" Top="472,44125" Width="1046,92981" OnBeforePrint="grfMaterialOnBeforePrint" Stretched="True">
      <TfrxMemoView Name="Memo28" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="626,92981" Top="0" Width="420" Height="16" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="2" Frame.LeftLine.Color="15790320" Frame.RightLine.Color="15790320" Fill.BackColor="14474460" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo30" IndexTag="1" Align="baRight" AllowVectorExport="True" Left="486,92981" Top="0" Width="140" Height="16" DataSet="SqlConsumo" DataSetName="SqlConsumo" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Color="16777215" Frame.Typ="3" Fill.BackColor="14474460" HAlign="haRight" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="[SUM(&#60;SqlConsumo.&#34;VL_TOTAL&#34;&#62;,bndConsumo)]"/>
      <TfrxMemoView Name="Memo31" IndexTag="1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="486,92981" Height="16" StretchMode="smMaxHeight" AllowHTMLTags="True" DataSet="SqlConsumo" DataSetName="SqlConsumo" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="3" Frame.LeftLine.Color="14474460" Frame.RightLine.Color="14474460" Fill.BackColor="14474460" ParentFont="False" VAlign="vaCenter" Text="Total do Material.: &#60;b&#62;[SqlConsumo.&#34;CD_MATERIAL&#34;] - [SqlConsumo.&#34;DS_MATERIAL&#34;]&#60;/b&#62;">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxGroupFooter>
  </inherited>
</inherited>
