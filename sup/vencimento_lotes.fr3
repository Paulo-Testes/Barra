<?xml version="1.0" encoding="utf-8" standalone="no"?>
<inherited ParentReport="SupPaisagem" PreviewOptions.AllowEdit="False" PreviewOptions.Buttons="1535" ReportOptions.Name="Vencimento de lotes" ReportOptions.LastChange="45492,691959213" ScriptText.Text="procedure grpLoteOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grpLote.Visible := &#60;TpVencimento&#62; = 2;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cabRelatorioOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  memCabLote.Width := Iif(&#60;TpVencimento&#62; in [1,2], 550, 470);&#13;&#10;  memCabVencimento.Visible := (&#60;TpVencimento&#62; in [1,2]);&#13;&#10;  memCabVencimento.Memo.Text := Iif(&#60;TpVencimento&#62; = 1, 'Vencido', 'Vencimento');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure memVencimentoOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  memVencimento.Visible := (&#60;TpVencimento&#62; in [1,2]);&#13;&#10;  if &#60;TpVencimento&#62; = 1 then&#13;&#10;  begin&#13;&#10;    if &#60;SqlLote.&#34;DIAS_VENCIDOS&#34;&#62; = 0 then&#13;&#10;      memVencimento.Memo.Text := 'Hoje'&#13;&#10;    else&#13;&#10;    if &#60;SqlLote.&#34;DIAS_VENCIDOS&#34;&#62; = 1 then&#13;&#10;      memVencimento.Memo.Text := 'Ontem'&#13;&#10;    else&#13;&#10;      memVencimento.Memo.Text := Format('Há %d dias', [&#60;SqlLote.&#34;DIAS_VENCIDOS&#34;&#62;]);&#13;&#10;  end&#13;&#10;  else&#13;&#10;  if &#60;TpVencimento&#62; = 2 then&#13;&#10;  begin&#13;&#10;    if &#60;SqlLote.&#34;DIAS_PARA_VENCER&#34;&#62; = 0 then&#13;&#10;      memVencimento.Memo.Text := 'Hoje'&#13;&#10;    else&#13;&#10;    if &#60;SqlLote.&#34;DIAS_PARA_VENCER&#34;&#62; = 1 then&#13;&#10;      memVencimento.Memo.Text := 'Amanhã'&#13;&#10;    else&#13;&#10;      memVencimento.Memo.Text := Format('Em %d dias', [&#60;SqlLote.&#34;DIAS_PARA_VENCER&#34;&#62;]);&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure grfLoteOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  grfLote.Visible := &#60;TpVencimento&#62; = 2;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  if &#60;IdRelatorioFiltro&#62; &#62; 0 then&#13;&#10;    SqlLote.SQL.Text := StringReplace(SqlLote.SQL.Text, '/*FILTRO_MATERIAL*/', 'AND A.ID_MATERIAL          = S.ID_FILTRO');&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="SqlCliente" DataSetName="SqlCliente"/>
    <item DataSet="SqlUsuario" DataSetName="SqlUsuario"/>
    <item DataSet="SqlModulo" DataSetName="SqlModulo"/>
    <item DataSet="SqlEntidade" DataSetName="SqlEntidade"/>
    <item DataSet="SqlLote" DataSetName="SqlLote"/>
    <item DataSet="SqlPeriodoVencimento" DataSetName="SqlPeriodoVencimento"/>
    <item DataSet="SqlAlmoxarifado" DataSetName="SqlAlmoxarifado"/>
    <item DataSet="SqlGrupo" DataSetName="SqlGrupo"/>
    <item DataSet="SqlSubGrupo" DataSetName="SqlSubGrupo"/>
  </Datasets>
  <Variables>
    <item InheritedName=" Internas"/>
    <item InheritedName="IdModulo"/>
    <item InheritedName="Personalizado"/>
    <item InheritedName="Formato"/>
    <item InheritedName="CodigoRelatorio"/>
    <item InheritedName=" Disponiveis"/>
    <item InheritedName="IdEntidade"/>
    <item InheritedName="IdRelatorioFiltro"/>
    <item InheritedName="Competencia"/>
    <item InheritedName=" Utilizadas"/>
    <item InheritedName="IdUsuario"/>
    <item Name="TpVencimento" Value="0"/>
    <item Name="DtVencimentoIni" Value="'01/01/2020'"/>
    <item Name="DtVencimentoFin" Value="'01/01/2020'"/>
    <item Name="SomenteMateriaisEmEstoque" Value="1"/>
    <item Name="DiasVencimento01" Value="10"/>
    <item Name="DiasVencimento02Ini" Value="11"/>
    <item Name="DiasVencimento02Fin" Value="20"/>
    <item Name="DiasVencimento03Ini" Value="21"/>
    <item Name="DiasVencimento03Fin" Value="30"/>
    <item Name="DiasVencimento04" Value="31"/>
    <item Name="IdAlmoxarifado" Value="-1"/>
    <item Name="IdGrupo" Value="-1"/>
    <item Name="IdGrupoPai" Value="-1"/>
  </Variables>
  <inherited Name="Data">
    <inherited Name="SqlCliente"/>
    <inherited Name="SqlUsuario"/>
    <inherited Name="SqlModulo"/>
    <inherited Name="SqlEntidade"/>
    <TfrxADOQuery Name="SqlLote" UserName="SqlLote" CloseDataSource="True" FieldAliases.Text="TP_AGRUPAMENTO=TP_AGRUPAMENTO&#13;&#10;DIAS_PARA_VENCER=DIAS_PARA_VENCER&#13;&#10;DIAS_VENCIDOS=DIAS_VENCIDOS&#13;&#10;ID_LOTE=ID_LOTE&#13;&#10;NR_LOTE=NR_LOTE&#13;&#10;DT_FABRICACAO=DT_FABRICACAO&#13;&#10;DT_VALIDADE=DT_VALIDADE&#13;&#10;CD_ALMOXARIFADO=CD_ALMOXARIFADO&#13;&#10;DS_ALMOXARIFADO=DS_ALMOXARIFADO&#13;&#10;CD_CLASSIFICACAO=CD_CLASSIFICACAO&#13;&#10;CD_MATERIAL=CD_MATERIAL&#13;&#10;DS_MATERIAL=DS_MATERIAL&#13;&#10;DS_COMPLETA=DS_COMPLETA&#13;&#10;UN_MATERIAL=UN_MATERIAL&#13;&#10;QTD=QTD&#13;&#10;DT_FABRICACAO_STR=DT_FABRICACAO_STR&#13;&#10;DT_VALIDADE_STR=DT_VALIDADE_STR" BCDToCurrency="False" IgnoreDupParams="True" SQL.Text="SELECT CAST(CASE WHEN 2 = :TP_VENCIMENTO AND A1.DIAS_PARA_VENCER &#60;= CAST(:DIAS_VENC_01     AS INTEGER) THEN '01'&#13;&#10;                 WHEN 2 = :TP_VENCIMENTO AND A1.DIAS_PARA_VENCER &#62;= CAST(:DIAS_VENC_02_INI AS INTEGER)&#13;&#10;                                         AND A1.DIAS_PARA_VENCER &#60;= CAST(:DIAS_VENC_02_FIN AS INTEGER) THEN '02'&#13;&#10;                 WHEN 2 = :TP_VENCIMENTO AND A1.DIAS_PARA_VENCER &#62;= CAST(:DIAS_VENC_03_INI AS INTEGER)&#13;&#10;                                         AND A1.DIAS_PARA_VENCER &#60;= CAST(:DIAS_VENC_03_FIN AS INTEGER) THEN '03'&#13;&#10;                 WHEN 2 = :TP_VENCIMENTO AND A1.DIAS_PARA_VENCER &#62;= CAST(:DIAS_VENC_04     AS INTEGER) THEN '04'&#13;&#10;                 ELSE '00'&#13;&#10;            END AS CHAR(2)) AS TP_AGRUPAMENTO&#13;&#10;     , A1.DIAS_PARA_VENCER&#13;&#10;     , A1.DIAS_VENCIDOS&#13;&#10;     , A1.ID_LOTE&#13;&#10;     , A1.NR_LOTE&#13;&#10;     , A1.DT_FABRICACAO&#13;&#10;     , A1.DT_VALIDADE&#13;&#10;     , A1.CD_ALMOXARIFADO&#13;&#10;     , A1.DS_ALMOXARIFADO&#13;&#10;     , A1.CD_CLASSIFICACAO&#13;&#10;     , A1.CD_MATERIAL&#13;&#10;     , A1.DS_MATERIAL&#13;&#10;     , A1.DS_COMPLETA&#13;&#10;     , A1.UN_MATERIAL&#13;&#10;     , A1.QTD&#13;&#10;     , CAST(LPAD(CAST(UDF_DAY(A1.DT_FABRICACAO)   AS VARCHAR(2)), 2, '0') || '/' ||&#13;&#10;            LPAD(CAST(UDF_MONTH(A1.DT_FABRICACAO) AS VARCHAR(2)), 2, '0') || '/' ||            &#13;&#10;            LPAD(CAST(UDF_YEAR(A1.DT_FABRICACAO)  AS VARCHAR(4)), 4, '0')&#13;&#10;            AS VARCHAR(20)) AS DT_FABRICACAO_STR&#13;&#10;     , CAST(LPAD(CAST(UDF_DAY(A1.DT_VALIDADE)     AS VARCHAR(2)), 2, '0') || '/' ||&#13;&#10;            LPAD(CAST(UDF_MONTH(A1.DT_VALIDADE)   AS VARCHAR(2)), 2, '0') || '/' ||            &#13;&#10;            LPAD(CAST(UDF_YEAR(A1.DT_VALIDADE)    AS VARCHAR(4)), 4, '0')&#13;&#10;            AS VARCHAR(20)) AS DT_VALIDADE_STR         &#13;&#10;  FROM (&#13;&#10;        SELECT A.ID_LOTE&#13;&#10;             , A.NR_LOTE&#13;&#10;             , A.DT_FABRICACAO&#13;&#10;             , A.DT_VALIDADE&#13;&#10;             , C.CD_ALMOXARIFADO&#13;&#10;             , C.DS_ALMOXARIFADO&#13;&#10;             , CAST(CAST(D.TP_MATERIAL           AS CHAR(1))               || '.' ||&#13;&#10;                         LPAD(CAST(F.CD_GRUPO    AS VARCHAR(20)), 3, '0')  || '.' ||&#13;&#10;                         LPAD(CAST(E.CD_GRUPO    AS VARCHAR(20)), 3, '0')  || '.' ||&#13;&#10;                         LPAD(CAST(D.CD_MATERIAL AS VARCHAR(20)), 6, '0')&#13;&#10;                         AS VARCHAR(120) )                                              AS CD_CLASSIFICACAO&#13;&#10;             , D.CD_MATERIAL&#13;&#10;             , D.DS_MATERIAL&#13;&#10;             , D.DS_COMPLETA&#13;&#10;             , D.UN_MATERIAL&#13;&#10;             , CAST('TODAY' AS DATE)                                                    AS HOJE&#13;&#10;             , CAST(CASE WHEN CAST('TODAY' AS DATE) &#60; A.DT_VALIDADE&#13;&#10;                         THEN UDF_DAYSBETWEEN(CAST('TODAY' AS DATE), A.DT_VALIDADE)&#13;&#10;                         ELSE 0&#13;&#10;                    END AS INTEGER)                                                     AS DIAS_PARA_VENCER  &#13;&#10;             , CAST(CASE WHEN CAST('TODAY' AS DATE) &#62; A.DT_VALIDADE&#13;&#10;                         THEN UDF_DAYSBETWEEN(A.DT_VALIDADE, CAST('TODAY' AS DATE))&#13;&#10;                         ELSE 0&#13;&#10;                    END AS INTEGER)                                                     AS DIAS_VENCIDOS&#13;&#10;             , SUM(B.QTD) AS QTD&#13;&#10;          FROM (&#13;&#10;                SELECT SRF.ID_FILTRO&#13;&#10;                  FROM SIS_RELATORIO_FILTRO SRF&#13;&#10;                 WHERE SRF.ID_RELATORIO_FILTRO = :ID_RELATORIO_FILTRO&#13;&#10;               ) S&#13;&#10;               RIGHT JOIN SUP_USUARIO                G ON G.ID_USUARIO           = :ID_USUARIO&#13;&#10;               LEFT JOIN  SUP_ACESSO_ALMOXARIFADO    H ON H.ID_GRUPO_USUARIO     = G.ID_GRUPO_USUARIO&#13;&#10;               LEFT JOIN  SUP_LOTE                   A ON A.ID_ALMOXARIFADO      = H.ID_ALMOXARIFADO&#13;&#10;                                                      /*FILTRO_MATERIAL*/&#13;&#10;               LEFT JOIN  SUP_LOTE_MOV               B ON B.ID_LOTE              = A.ID_LOTE&#13;&#10;               LEFT JOIN  SUP_ALMOXARIFADO           C ON C.ID_ALMOXARIFADO      = A.ID_ALMOXARIFADO&#13;&#10;               LEFT JOIN  SUP_MATERIAL               D ON D.ID_MATERIAL          = A.ID_MATERIAL&#13;&#10;               LEFT JOIN  SUP_GRUPO                  E ON E.ID_GRUPO             = D.ID_GRUPO&#13;&#10;               LEFT JOIN  SUP_GRUPO                  F ON F.ID_GRUPO             = E.ID_GRUPO_PAI&#13;&#10;         WHERE G.ID_USUARIO   = :ID_USUARIO&#13;&#10;           AND C.ID_ENTIDADE  = :ID_ENTIDADE                                                                                                    &#13;&#10;           AND ( H.ALMOXARIFE = 1 OR H.CONSULTAR = 1 )&#13;&#10;           AND A.ID_LOTE      IS NOT NULL&#13;&#10;           AND ( A.ID_ALMOXARIFADO = :ID_ALMOXARIFADO OR -1 = :ID_ALMOXARIFADO )&#13;&#10;           AND (E.ID_GRUPO = :ID_GRUPO OR -1 = :ID_GRUPO)&#13;&#10;           AND (F.ID_GRUPO = :ID_GRUPO_PAI OR -1 = :ID_GRUPO_PAI)&#13;&#10;           /*FILTRO_MATERIAL*/&#13;&#10;           AND ( (1 = :TP_VENCIMENTO AND A.DT_VALIDADE  &#60; CAST('TODAY' AS DATE)) OR 1 &#60;&#62; :TP_VENCIMENTO )&#13;&#10;           AND ( (2 = :TP_VENCIMENTO AND A.DT_VALIDADE &#62;= CAST('TODAY' AS DATE)&#13;&#10;                                     AND A.DT_VALIDADE &#62;= :DT_VENCIMENTO_INI&#13;&#10;                                     AND A.DT_VALIDADE &#60;= :DT_VENCIMENTO_FIN   ) OR 2 &#60;&#62; :TP_VENCIMENTO )&#13;&#10;        &#13;&#10;         GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14&#13;&#10;        HAVING (1 = :EXIBIR_SOMENTE_EM_ESTOQUE AND ROUND(SUM(B.QTD), 4) &#62; 0) OR&#13;&#10;               (0 = :EXIBIR_SOMENTE_EM_ESTOQUE)&#13;&#10;       ) A1&#13;&#10; ORDER BY 1,2,3,10       " CommandTimeout="3000" LockType="ltReadOnly" PropData="05704C656674027C0470546F7003CB000A506172616D65746572730101064E204E616D653D2254505F56454E43494D454E544F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B547056656E63696D656E746F262336323B2200010651204E616D653D22444941535F56454E435F3031222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4469617356656E63696D656E746F3031262336323B2200010658204E616D653D22444941535F56454E435F30325F494E49222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4469617356656E63696D656E746F3032496E69262336323B2200010658204E616D653D22444941535F56454E435F30325F46494E222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4469617356656E63696D656E746F303246696E262336323B2200010658204E616D653D22444941535F56454E435F30335F494E49222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4469617356656E63696D656E746F3033496E69262336323B2200010658204E616D653D22444941535F56454E435F30335F46494E222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4469617356656E63696D656E746F303346696E262336323B2200010651204E616D653D22444941535F56454E435F3034222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4469617356656E63696D656E746F3034262336323B2200010659204E616D653D2249445F52454C41544F52494F5F46494C54524F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B496452656C61746F72696F46696C74726F262336323B2200010648204E616D653D2249445F5553554152494F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49645573756172696F262336323B220001064A204E616D653D2249445F454E544944414445222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964456E746964616465262336323B2200010652204E616D653D2249445F414C4D4F584152494641444F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964416C6D6F786172696661646F262336323B2200010644204E616D653D2249445F475255504F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F262336323B220001064B204E616D653D2249445F475255504F5F504149222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F506169262336323B2200010677204E616D653D2244545F56454E43494D454E544F5F494E49222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B53716C506572696F646F56656E63696D656E746F2E262333343B44545F56454E43494D454E544F5F494E49262333343B262336323B2200010677204E616D653D2244545F56454E43494D454E544F5F46494E222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B53716C506572696F646F56656E63696D656E746F2E262333343B44545F56454E43494D454E544F5F46494E262333343B262336323B2200010667204E616D653D224558494249525F534F4D454E54455F454D5F4553544F515545222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B536F6D656E74654D6174657269616973456D4573746F717565262336323B220000"/>
    <TfrxADOQuery Name="SqlPeriodoVencimento" UserName="SqlPeriodoVencimento" CloseDataSource="True" FieldAliases.Text="DT_VENCIMENTO_INI=DT_VENCIMENTO_INI&#13;&#10;DT_VENCIMENTO_FIN=DT_VENCIMENTO_FIN" BCDToCurrency="False" IgnoreDupParams="True" SQL.Text="SELECT UDF_ENCDATE(:ANO_INI, :MES_INI, :DIA_INI) AS DT_VENCIMENTO_INI                                    &#13;&#10;     , UDF_ENCDATE(:ANO_FIN, :MES_FIN, :DIA_FIN) AS DT_VENCIMENTO_FIN                            &#13;&#10;  FROM SIS_SEQUENCIA A&#13;&#10; WHERE A.ID_SEQUENCIA = 1     " CommandTimeout="3000" LockType="ltReadOnly" PropData="05704C656674027C0470546F700389000A506172616D657465727301010659204E616D653D22414E4F5F494E49222044617461547970653D226674536D616C6C696E74222045787072657373696F6E3D22457874726163745965617228262336303B447456656E63696D656E746F496E69262336323B29220001065A204E616D653D224D45535F494E49222044617461547970653D226674536D616C6C696E74222045787072657373696F6E3D22457874726163744D6F6E746828262336303B447456656E63696D656E746F496E69262336323B292200010658204E616D653D224449415F494E49222044617461547970653D226674536D616C6C696E74222045787072657373696F6E3D224578747261637444617928262336303B447456656E63696D656E746F496E69262336323B292200010659204E616D653D22414E4F5F46494E222044617461547970653D226674536D616C6C696E74222045787072657373696F6E3D22457874726163745965617228262336303B447456656E63696D656E746F46696E262336323B29220001065A204E616D653D224D45535F46494E222044617461547970653D226674536D616C6C696E74222045787072657373696F6E3D22457874726163744D6F6E746828262336303B447456656E63696D656E746F46696E262336323B292200010658204E616D653D224449415F46494E222044617461547970653D226674536D616C6C696E74222045787072657373696F6E3D224578747261637444617928262336303B447456656E63696D656E746F46696E262336323B29220000"/>
    <TfrxADOQuery Name="SqlAlmoxarifado" UserName="SqlAlmoxarifado" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.CD_ALMOXARIFADO&#13;&#10;     , TRIM(A.DS_ALMOXARIFADO) AS DS_ALMOXARIFADO              &#13;&#10;  FROM SUP_ALMOXARIFADO A&#13;&#10; WHERE A.ID_ALMOXARIFADO = :ID_ALMOXARIFADO  " CommandTimeout="3000" LockType="ltReadOnly" PropData="05704C65667403CC000470546F7003C9000A506172616D657465727301010652204E616D653D2249445F414C4D4F584152494641444F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964416C6D6F786172696661646F262336323B220000"/>
    <TfrxADOQuery Name="SqlGrupo" UserName="SqlGrupo" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text=" SELECT A.CD_GRUPO&#13;&#10;     , TRIM(A.DS_GRUPO) AS DS_GRUPO              &#13;&#10;  FROM SUP_GRUPO A&#13;&#10; WHERE A.ID_GRUPO = :ID_GRUPO_PAI  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740330010470546F7003C8000A506172616D65746572730101064B204E616D653D2249445F475255504F5F504149222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F506169262336323B220000"/>
    <TfrxADOQuery Name="SqlSubGrupo" UserName="SqlSubGrupo" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.CD_GRUPO AS CD_SUBGRUPO&#13;&#10;     , TRIM(A.DS_GRUPO) AS DS_SUBGRUPO&#13;&#10;  FROM SUP_GRUPO A&#13;&#10; WHERE A.ID_GRUPO = :ID_GRUPO  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740398010470546F7003C8000A506172616D657465727301010644204E616D653D2249445F475255504F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4964477275706F262336323B220000"/>
  </inherited>
  <inherited Name="Page1" PaperSize="9" Frame.Color="16777215">
    <inherited Name="bndCabecalho" Child="bndFiltro">
      <inherited Name="Logo"/>
      <inherited Name="Brasao"/>
      <inherited Name="TxtNomeCliente"/>
      <inherited Name="TxtTitulo1"/>
      <inherited Name="TxtTitulo2"/>
      <inherited Name="TxtTituloRelatorio" Text="Vencimento de lotes"/>
      <inherited Name="Line1"/>
      <inherited Name="TxtData"/>
      <inherited Name="TxtHora"/>
      <inherited Name="TxtCompetencia"/>
    </inherited>
    <inherited Name="BndRodape" Top="389,29159">
      <inherited Name="Line2"/>
      <inherited Name="TxtRodape"/>
      <inherited Name="TxtPaginacao"/>
      <inherited Name="TxtDataHora"/>
    </inherited>
    <TfrxHeader Name="cabRelatorio" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="27" Left="0" Top="230,55133" Width="1046,92981" OnBeforePrint="cabRelatorioOnBeforePrint" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo1" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="496,92981" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Material"/>
      <TfrxMemoView Name="Memo3" Align="baRight" AllowVectorExport="True" Left="886,92981" Top="13" Width="80" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Quantidade"/>
      <TfrxMemoView Name="Memo14" Align="baLeft" AllowVectorExport="True" Left="0" Top="13" Width="70" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Classificação"/>
      <TfrxMemoView Name="Memo15" Align="baWidth" AllowVectorExport="True" Left="70" Top="13" Width="386,92981" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Descrição"/>
      <TfrxMemoView Name="Memo16" Align="baRight" AllowVectorExport="True" Left="456,92981" Top="13" Width="40" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="U.M."/>
      <TfrxMemoView Name="Memo17" Align="baRight" AllowVectorExport="True" Left="496,92981" Top="13" Width="200" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Almoxarifado"/>
      <TfrxMemoView Name="memCabLote" Align="baRight" AllowVectorExport="True" Left="496,92981" Top="0" Width="550" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Lote"/>
      <TfrxMemoView Name="Memo11" Align="baRight" AllowVectorExport="True" Left="696,92981" Top="13" Width="70" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Número"/>
      <TfrxMemoView Name="Memo12" Align="baRight" AllowVectorExport="True" Left="766,92981" Top="13" Width="60" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Fabricação"/>
      <TfrxMemoView Name="Memo13" Align="baRight" AllowVectorExport="True" Left="826,92981" Top="13" Width="60" Height="13" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Validade"/>
      <TfrxMemoView Name="memCabVencimento" Align="baRight" AllowVectorExport="True" Left="966,92981" Top="13" Width="80" Height="13" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="1" Font.Color="16777215" Font.Height="-8" Font.Name="Tahoma" Font.Style="1" Frame.Color="16777215" Frame.Typ="15" Fill.BackColor="7754282" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Vencimento"/>
    </TfrxHeader>
    <TfrxChild Name="bndFiltro" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="8" Height="15" Left="0" Top="113,3859" Width="1046,92981" OnBeforePrint="bndFiltroOnBeforePrint" Stretched="True" ToNRows="0" ToNRowsMode="rmCount">
      <TfrxMemoView Name="TxtPeriodo" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="15" StretchMode="smMaxHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="Vencimento: [IIF(&#60;TpVencimento&#62; = 1, '&#60;b&#62;Lotes vencidos&#60;/b&#62;', IIF(&#60;TpVencimento&#62; = 2, '&#60;b&#62;Lotes à vencer&#60;/b&#62;', 'Todos os lotes'))][IIF(&#60;TpVencimento&#62; = 2, Format(' | Data de vencimento entre &#60;b&#62;%s&#60;/b&#62; e &#60;b&#62;%s&#60;/b&#62;', [&#60;DtVencimentoIni&#62;, &#60;DtVencimentoFin&#62;]), '')][IIF(&#60;IdAlmoxarifado&#62; &#62; 0, Format(' | Almoxarifado: &#60;b&#62;%d - %s&#60;/b&#62;', [&#60;SqlAlmoxarifado.&#34;CD_ALMOXARIFADO&#34;&#62;, &#60;SqlAlmoxarifado.&#34;DS_ALMOXARIFADO&#34;&#62;]), '')][IIF(&#60;IdGrupoPai&#62; &#60;&#62; -1, Format(' | Grupo: &#60;b&#62;%d - %s&#60;/b&#62;', [&#60;SqlGrupo.&#34;CD_GRUPO&#34;&#62;, &#60;SqlGrupo.&#34;DS_GRUPO&#34;&#62;]), '')][IIF(&#60;IdGrupo&#62; &#60;&#62; -1, Format(' | Subgrupo: &#60;b&#62;%d - %s&#60;/b&#62;', [&#60;SqlSubgrupo.&#34;CD_SUBGRUPO&#34;&#62;, &#60;SqlSubgrupo.&#34;DS_SUBGRUPO&#34;&#62;]), '')]">
        <Formats>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxChild>
    <TfrxMasterData Name="bndLote" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="12" Left="0" Top="279,68522" Width="1046,92981" AllowSplit="True" ColumnWidth="0" ColumnGap="0" DataSet="SqlLote" DataSetName="SqlLote" KeepChild="True" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo8" Align="baWidth" AllowVectorExport="True" Left="70" Top="0" Width="386,92981" Height="12" StretchMode="smMaxHeight" DataField="DS_MATERIAL" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="[SqlLote.&#34;DS_MATERIAL&#34;]">
        <Formats>
          <item FormatStr="0000000" Kind="fkNumeric"/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="MvMinimo" Align="baRight" AllowVectorExport="True" Left="886,92981" Top="0" Width="80" Height="12" DataField="QTD" DataSet="SqlLote" DataSetName="SqlLote" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.4n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" HAlign="haRight" ParentFont="False" Text="[SqlLote.&#34;QTD&#34;]"/>
      <TfrxMemoView Name="Memo9" Align="baLeft" AllowVectorExport="True" Left="0" Top="0" Width="70" Height="12" DataField="CD_CLASSIFICACAO" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="[SqlLote.&#34;CD_CLASSIFICACAO&#34;]"/>
      <TfrxMemoView Name="Memo18" Align="baRight" AllowVectorExport="True" Left="456,92981" Top="0" Width="40" Height="12" DataField="UN_MATERIAL" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[SqlLote.&#34;UN_MATERIAL&#34;]">
        <Formats>
          <item FormatStr="0000000" Kind="fkNumeric"/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo20" Align="baRight" AllowVectorExport="True" Left="496,92981" Top="0" Width="200" Height="12" StretchMode="smMaxHeight" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="[SqlLote.&#34;CD_ALMOXARIFADO&#34;] - [SqlLote.&#34;DS_ALMOXARIFADO&#34;]">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo21" Align="baRight" AllowVectorExport="True" Left="696,92981" Top="0" Width="70" Height="12" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="[SqlLote.&#34;NR_LOTE&#34;]"/>
      <TfrxMemoView Name="Memo22" Align="baRight" AllowVectorExport="True" Left="766,92981" Top="0" Width="60" Height="12" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="[SqlLote.&#34;DT_FABRICACAO_STR&#34;]"/>
      <TfrxMemoView Name="Memo23" Align="baRight" AllowVectorExport="True" Left="826,92981" Top="0" Width="60" Height="12" DataField="DT_VALIDADE_STR" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="[SqlLote.&#34;DT_VALIDADE_STR&#34;]"/>
      <TfrxMemoView Name="memVencimento" Align="baRight" AllowVectorExport="True" Left="966,92981" Top="0" Width="80" Height="12" OnBeforePrint="memVencimentoOnBeforePrint" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" HAlign="haRight" ParentFont="False" Text=""/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="grpLote" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="20" Left="0" Top="188,9765" Width="1046,92981" OnBeforePrint="grpLoteOnBeforePrint" Condition="SqlLote.&#34;TP_AGRUPAMENTO&#34;" ReprintOnNewPage="True">
      <TfrxMemoView Name="SqlLoteTP_AGRUPAMENTO" IndexTag="1" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="20" DataSet="SqlLote" DataSetName="SqlLote" Font.Charset="0" Font.Color="-16777208" Font.Height="-9" Font.Name="Tahoma" Font.Style="1" Font.Quality="fqClearTypeNatural" Frame.Color="16777215" Frame.Typ="11" Fill.BackColor="-16777201" ParentFont="False" VAlign="vaBottom" Text="[IIF(&#60;SqlLote.&#34;TP_AGRUPAMENTO&#34;&#62; = '01', Format('Materiais com vencimento para os próximos %d dias', [StrToInt(&#60;DiasVencimento01&#62;)]), IIF(&#60;SqlLote.&#34;TP_AGRUPAMENTO&#34;&#62; = '02', Format('Materiais com vencimento entre %d e %d dias', [StrToInt(&#60;DiasVencimento02Ini&#62;), StrToInt(&#60;DiasVencimento02Fin&#62;)]), IIF(&#60;SqlLote.&#34;TP_AGRUPAMENTO&#34;&#62; = '03', Format('Materiais com vencimento entre %d e %d dias', [StrToInt(&#60;DiasVencimento03Ini&#62;), StrToInt(&#60;DiasVencimento03Fin&#62;)]), IIF(&#60;SqlLote.&#34;TP_AGRUPAMENTO&#34;&#62; = '04', Format('Materiais com vencimento superior a %d dias', [StrToInt(&#60;DiasVencimento04&#62;)]), ''))))]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="grfLote" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="15" Left="0" Top="313,70099" Width="1046,92981" OnBeforePrint="grfLoteOnBeforePrint"/>
  </inherited>
</inherited>
