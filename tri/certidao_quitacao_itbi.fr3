<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="6.4.12" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.AllowEdit="False" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PrintOptions.Printer="Padrão" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="44706,6855262037" ReportOptions.Description.Text="" ReportOptions.LastChange="45693,6064289931" ScriptLanguage="PascalScript" ScriptText.Text="function retornaTexto(nome_campo: String): String;&#13;&#10;var&#13;&#10;   texto_completo, valor_campo, texto_linha, texto_retorno : String;&#13;&#10;   pos_enter : integer;&#13;&#10;begin&#13;&#10;   // Campo inicial&#13;&#10;   valor_campo := &#60;SqlCertidao.&#34;campos&#34;&#62;;&#13;&#10;   // Removendo a primeira linha&#13;&#10;   texto_retorno := '';&#13;&#10;   texto_completo := copy(valor_campo,pos(chr(13),valor_campo) +1,length(valor_campo));&#13;&#10;   // Laço&#13;&#10;   while (pos(chr(13),texto_completo) &#62; 0) do&#13;&#10;   begin&#13;&#10;      texto_linha := copy(texto_completo,1,pos(chr(13),texto_completo));&#13;&#10;      if (pos(nome_campo,texto_linha) &#62; 0) then&#13;&#10;      begin&#13;&#10;         texto_retorno := copy(texto_linha,pos(':',texto_linha) +2,length(texto_linha));&#13;&#10;         break;&#13;&#10;      end;&#13;&#10;&#13;&#10;      // Pegando a próxima linha&#13;&#10;      texto_completo := copy(texto_completo,pos(chr(13),texto_completo) +1,length(texto_completo));&#13;&#10;   end;&#13;&#10;&#13;&#10;   Result := texto_retorno;&#13;&#10;end;&#13;&#10;&#13;&#10;function numSql(num: String) : String;&#13;&#10;begin&#13;&#10;   // Trato p/ se for vazio retornar 0&#13;&#10;   if num = '' then&#13;&#10;      num := '0';&#13;&#10;&#13;&#10;   // Se existir , (virgula) troco todos os pontos por ''&#13;&#10;   if Pos(',',num) &#62; 0 then&#13;&#10;   begin&#13;&#10;      Repeat&#13;&#10;        num := StringReplace(num,'.','');&#13;&#10;      until Pos('.',num) = 0;&#13;&#10;   end;&#13;&#10;&#13;&#10;   // Troco a vírgula por ponto&#13;&#10;   num := StringReplace(num,',','.');&#13;&#10;&#13;&#10;   Result := num;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo25OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  cpf_cnpj : String;&#13;&#10;begin&#13;&#10;  cpf_cnpj := Trim(retornaTexto('Cpf_cnpj_comprador'));&#13;&#10;  case Length(cpf_cnpj) of&#13;&#10;    11: n_cpf_cnpj.Text := Copy(cpf_cnpj,1,3)+'.'+Copy(cpf_cnpj,4,3)+'.'+Copy(cpf_cnpj,7,3)+'-'+Copy(cpf_cnpj,10,2);&#13;&#10;    14: n_cpf_cnpj.Text := Copy(cpf_cnpj,1,2)+'.'+Copy(cpf_cnpj,3,3)+'.'+Copy(cpf_cnpj,6,3)+'/'+Copy(cpf_cnpj,9,4)+'-'+Copy(cpf_cnpj,13,2);&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo4OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  cpf_cnpj : String;&#13;&#10;begin&#13;&#10;  cpf_cnpj := Trim(retornaTexto('Cpf_cnpj_vendedor'));&#13;&#10;  case Length(cpf_cnpj) of&#13;&#10;    11: m_cpf_cnpj.Text := Copy(cpf_cnpj,1,3)+'.'+Copy(cpf_cnpj,4,3)+'.'+Copy(cpf_cnpj,7,3)+'-'+Copy(cpf_cnpj,10,2);&#13;&#10;    14: m_cpf_cnpj.Text := Copy(cpf_cnpj,1,2)+'.'+Copy(cpf_cnpj,3,3)+'.'+Copy(cpf_cnpj,6,3)+'/'+Copy(cpf_cnpj,9,4)+'-'+Copy(cpf_cnpj,13,2);&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo5OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  cpf_cnpj : String;&#13;&#10;begin&#13;&#10;  cpf_cnpj := &#60;SqlCliente.&#34;cnpj&#34;&#62;;&#13;&#10;  case Length(cpf_cnpj) of&#13;&#10;    11: m_cpf_cnpj_entidade.Text := Copy(cpf_cnpj,1,3)+'.'+Copy(cpf_cnpj,4,3)+'.'+Copy(cpf_cnpj,7,3)+'-'+Copy(cpf_cnpj,9,2);&#13;&#10;    14: m_cpf_cnpj_entidade.Text := Copy(cpf_cnpj,1,2)+'.'+Copy(cpf_cnpj,3,3)+'.'+Copy(cpf_cnpj,6,3)+'/'+Copy(cpf_cnpj,9,4)+'-'+Copy(cpf_cnpj,13,2);&#13;&#10;  end;&#13;&#10;end;&#13;&#10;procedure Memo36OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Memo36.text := Copy(Trim(retornaTexto('Nome_vendedor')),1,45);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo38OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Memo38.text := Copy(Trim(retornaTexto('Nome_comprador')),1,45);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;   valor, val_extenso, endereco_imovel, numero_imovel, complemento_imovel, bairro_imovel, cep_imovel,&#13;&#10;   municipio_intermediador, uf_intermediador  : String;&#13;&#10;begin&#13;&#10;   valor := Trim(retornaTexto('Valor_itbi'));&#13;&#10;   SqlExtenso.Sql.Text := 'select valorextenso from sis_retorna_extenso('+numSql(valor)+', ''S'') ';&#13;&#10;   SqlExtenso.Open;&#13;&#10;   val_extenso := SqlExtenso.fieldbyname('valorextenso').AsString;&#13;&#10;&#13;&#10;   // Iniciando as variáveis vazias&#13;&#10;   endereco_imovel := '';&#13;&#10;   numero_imovel := '';&#13;&#10;   complemento_imovel  := '';&#13;&#10;   bairro_imovel := '';&#13;&#10;   cep_imovel := '';&#13;&#10;   municipio_intermediador := '';&#13;&#10;   uf_intermediador := '';&#13;&#10;&#13;&#10;   // Verificando se tem conteúdo e carregando as váriaveis&#13;&#10;   if UpperCase(Trim(retornaTexto('Endereco_imovel'))) &#60;&#62; '' then&#13;&#10;      endereco_imovel := UpperCase(Trim(retornaTexto('Endereco_imovel')))+', ';&#13;&#10;   if UpperCase(Trim(retornaTexto('Numero_imovel'))) &#60;&#62; '' then&#13;&#10;      numero_imovel := 'Nº: '+UpperCase(Trim(retornaTexto('Numero_imovel')))+', ';&#13;&#10;   if UpperCase(Trim(retornaTexto('Complemento_imovel'))) &#60;&#62; '' then&#13;&#10;      complemento_imovel := 'Complemento: '+UpperCase(Trim(retornaTexto('Complemento_imovel')))+', ';&#13;&#10;   if UpperCase(Trim(retornaTexto('Bairro_imovel'))) &#60;&#62; '' then&#13;&#10;      bairro_imovel := 'Bairro: '+UpperCase(Trim(retornaTexto('Bairro_imovel')))+', ';&#13;&#10;   if UpperCase(Trim(retornaTexto('Cep_imovel'))) &#60;&#62; '' then&#13;&#10;      cep_imovel := 'CEP: '+UpperCase(Trim(retornaTexto('Cep_imovel')))+', ';&#13;&#10;   if UpperCase(Trim(retornaTexto('Municipio_intermediador'))) &#60;&#62; '' then&#13;&#10;      municipio_intermediador := UpperCase(Trim(retornaTexto('Municipio_intermediador')))+' / ';&#13;&#10;   if UpperCase(Trim(retornaTexto('Uf_intermediador'))) &#60;&#62; '' then&#13;&#10;      uf_intermediador := UpperCase(Trim(retornaTexto('Uf_intermediador')))+', ';&#13;&#10;&#13;&#10;&#13;&#10;   // Para usar a function retornaTexto é necessário passar apenas o nome do campo&#13;&#10;   Memo1.text := 'Certificamos, para os devidos fins, que o imóvel de inscrição nº&#60;b&#62; '+&#13;&#10;                  UpperCase(Trim(retornaTexto('Inscricao_imovel')))+'&#60;/b&#62; sito à '+&#13;&#10;                  endereco_imovel+&#13;&#10;                  numero_imovel+&#13;&#10;                  complemento_imovel+&#13;&#10;                  bairro_imovel+&#13;&#10;                  cep_imovel+&#13;&#10;                  municipio_intermediador+&#13;&#10;                  uf_intermediador+&#13;&#10;                  'recebeu um lançamento de &#60;b&#62;ITBI&#60;/b&#62; realizado em '+&#13;&#10;                  '&#60;b&#62;[SqlCarne.&#34;data_criacao&#34;]&#60;/b&#62;, no valor de &#60;b&#62;R$ '+&#13;&#10;                  Trim(retornaTexto('Valor_itbi'))+'&#60;/b&#62; '+&#13;&#10;                  '('+val_extenso+') '+&#13;&#10;                  'entre as partes:';&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo12OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;   valor_parcela, vlr_pago, val_parcela_extenso, val_pago_extenso : String;&#13;&#10;begin&#13;&#10;   // Pegando valor extenso da parcela&#13;&#10;   valor_parcela := FloatToStr(&#60;SqlCarne.&#34;vl_parcela&#34;&#62;);&#13;&#10;   SqlExtenso.Sql.Text := 'select valorextenso from sis_retorna_extenso('+numSql(valor_parcela)+', ''S'') ';&#13;&#10;   SqlExtenso.Open;&#13;&#10;   val_parcela_extenso := SqlExtenso.fieldbyname('valorextenso').AsString;&#13;&#10;&#13;&#10;   // Pegando valor extenso referente ao valor pago&#13;&#10;   vlr_pago := FloatToStr(&#60;SqlCarne.&#34;vlr_pago&#34;&#62;);&#13;&#10;   SqlExtenso.Sql.Text := 'select valorextenso from sis_retorna_extenso('+numSql(vlr_pago)+', ''S'') ';&#13;&#10;   SqlExtenso.Open;&#13;&#10;   val_pago_extenso := SqlExtenso.fieldbyname('valorextenso').AsString;&#13;&#10;&#13;&#10;   // Para usar a function retornaTexto é necessário passar apenas o nome do campo&#13;&#10;   Memo12.text := 'O referido lançamento gerou a guia nº &#60;b&#62;[SqlCertidao.&#34;id_lancamento&#34;] / [SqlDadosCertidao.&#34;ano&#34;]&#60;/b&#62; com o valor de '+&#13;&#10;                  '&#60;b&#62;R$[FormatFloat('',0.00 '',&#60;SqlCarne.&#34;vl_parcela&#34;&#62;)]&#60;/b&#62;'+&#13;&#10;                  '('+val_parcela_extenso+'), ' +&#13;&#10;                  'de natureza de transação &#60;b&#62;'+&#13;&#10;                  UpperCase(Trim(retornaTexto('Natureza_transacao')))+&#13;&#10;                  '&#60;/b&#62;, que foi devidamente &#60;b&#62;quitada&#60;/b&#62; na data de &#60;b&#62;[SqlCarne.&#34;data_quitacao&#34;]&#60;/b&#62; pelo valor pago de '+&#13;&#10;                  '&#60;b&#62;R$[FormatFloat('',0.00 '',&#60;SqlCarne.&#34;vlr_pago&#34;&#62;)]&#60;/b&#62;'+&#13;&#10;                  '('+val_pago_extenso+').';&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False">
  <Datasets>
    <item DataSet="SqlCliente" DataSetName="SqlCliente"/>
    <item DataSet="SqlUsuario" DataSetName="SqlUsuario"/>
    <item DataSet="SqlModulo" DataSetName="SqlModulo"/>
    <item DataSet="SqlDadosCertidao" DataSetName="SqlDadosCertidao"/>
    <item DataSet="SqlCertidao" DataSetName="SqlCertidao"/>
    <item DataSet="SqlCrypt" DataSetName="SqlCrypt"/>
    <item DataSet="SqlCarne" DataSetName="SqlCarne"/>
    <item DataSet="SqlExtenso" DataSetName="SqlExtenso"/>
  </Datasets>
  <Variables>
    <item Name=" relatorio"/>
    <item Name="referencial"/>
    <item Name="ip_acessado" Value="''"/>
    <item Name="id_carne"/>
  </Variables>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADOQuery Name="SqlCliente" UserName="SqlCliente" CloseDataSource="True" FieldAliases.Text="NOME=NOME&#13;&#10;NOME_REDUZIDO=NOME_REDUZIDO&#13;&#10;ENDERECO=ENDERECO&#13;&#10;BAIRRO=BAIRRO&#13;&#10;CODIGO_MUNICIPIO=CODIGO_MUNICIPIO&#13;&#10;NOME_MUNICIPIO=NOME_MUNICIPIO&#13;&#10;UF=UF&#13;&#10;CEP=CEP&#13;&#10;TELEFONE=TELEFONE&#13;&#10;FAX=FAX&#13;&#10;EMAIL=EMAIL&#13;&#10;SITE=SITE&#13;&#10;CNPJ=CNPJ&#13;&#10;SLOGAN=SLOGAN&#13;&#10;LOGOTIPO=LOGOTIPO" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT TRIM(A.NOME)           AS NOME                       &#13;&#10;     , TRIM(A.NOME_REDUZIDO)  AS NOME_REDUZIDO       &#13;&#10;     , TRIM(A.ENDERECO)       AS ENDERECO       &#13;&#10;     , TRIM(A.BAIRRO)         AS BAIRRO       &#13;&#10;     , A.CODIGO_MUNICIPIO  &#13;&#10;     , TRIM(B.NOME_MUNICIPIO) AS NOME_MUNICIPIO&#13;&#10;     , TRIM(B.UF)             AS UF       &#13;&#10;     , TRIM(A.CEP)            AS CEP       &#13;&#10;     , TRIM(A.TELEFONE)       AS TELEFONE       &#13;&#10;     , TRIM(A.FAX)            AS FAX       &#13;&#10;     , TRIM(A.EMAIL)          AS EMAIL       &#13;&#10;     , TRIM(A.SITE)           AS SITE       &#13;&#10;     , TRIM(A.CGC)            AS CNPJ                                      &#13;&#10;     , TRIM(A.SLOGAN)         AS SLOGAN       &#13;&#10;     , A.LOGOTIPO&#13;&#10;  FROM AAC_CLIENTES A&#13;&#10;       LEFT JOIN AAC_MUNICIPIOS B ON B.CODIGO_MUNICIPIO = A.CODIGO_MUNICIPIO&#13;&#10;  ROWS 1    " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C65667402480470546F70022B0A506172616D65746572730100"/>
    <TfrxADOQuery Name="SqlUsuario" UserName="SqlUsuario" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.ID_USUARIO&#13;&#10;     , TRIM(A.DS_USUARIO) AS DS_USUARIO&#13;&#10;     , A.NOME_USUARIO&#13;&#10;     , A.EMAIL&#13;&#10;  FROM SIS_USUARIO A&#13;&#10; WHERE A.ID_USUARIO = :ID_USUARIO  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740397000470546F70022B0A506172616D657465727301010649204E616D653D2249445F5553554152494F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49645F5573756172696F262336323B220000"/>
    <TfrxADOQuery Name="SqlModulo" UserName="SqlModulo" CloseDataSource="True" FieldAliases.Text="ID_MODULO=ID_MODULO&#13;&#10;DS_MODULO=DS_MODULO&#13;&#10;SIGLA_MODULO=SIGLA_MODULO&#13;&#10;TITULO_1=TITULO_1&#13;&#10;TITULO_2=TITULO_2&#13;&#10;SERIE=SERIE&#13;&#10;VERSAO=VERSAO&#13;&#10;USA_IMAGEM=USA_IMAGEM&#13;&#10;IMAGEM=IMAGEM&#13;&#10;IMPRIMIR_DATA_HORA_RODAPE=IMPRIMIR_DATA_HORA_RODAPE&#13;&#10;IMPRIMIR_DATA=IMPRIMIR_DATA&#13;&#10;IMPRIMIR_HORA=IMPRIMIR_HORA&#13;&#10;IMPRIMIR_USUARIO=IMPRIMIR_USUARIO" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT A.ID_MODULO&#13;&#10;     , A.DS_MODULO&#13;&#10;     , A.SIGLA_MODULO&#13;&#10;     , A.TITULO_1&#13;&#10;     , A.TITULO_2&#13;&#10;     , A.SERIE&#13;&#10;     , A.VERSAO&#13;&#10;&#13;&#10;     , CAST(CASE WHEN B.IMAGEM IS NULL THEN 0 ELSE 1 END AS SMALLINT) AS USA_IMAGEM&#13;&#10;     , B.IMAGEM&#13;&#10;&#13;&#10;     , COALESCE(C.IMPRIMIR_DATA_HORA_RODAPE, 0) AS IMPRIMIR_DATA_HORA_RODAPE&#13;&#10;     , COALESCE(CASE WHEN C.IMPRIMIR_DATA = 2 THEN D.IMPRIMIR_DATA ELSE C.IMPRIMIR_DATA END, 1) AS IMPRIMIR_DATA&#13;&#10;     , COALESCE(CASE WHEN C.IMPRIMIR_HORA = 2 THEN D.IMPRIMIR_HORA ELSE C.IMPRIMIR_HORA END, 1) AS IMPRIMIR_HORA&#13;&#10;     , COALESCE(CASE WHEN C.IMPRIMIR_USUARIO = 2 THEN D.IMPRIMIR_USUARIO ELSE C.IMPRIMIR_USUARIO END, 1) AS IMPRIMIR_USUARIO&#13;&#10;&#13;&#10;  FROM SIS_MODULO A&#13;&#10;       LEFT JOIN SIS_ENTIDADE             B ON B.ID_ENTIDADE = :ID_ENTIDADE&#13;&#10;       LEFT JOIN SIS_MODULO_CONFIGURACAO  C ON C.ID_MODULO   = A.ID_MODULO&#13;&#10;       LEFT JOIN SIS_USUARIO_CONFIGURACAO D ON D.ID_MODULO   = A.ID_MODULO&#13;&#10;                                           AND D.ID_USUARIO  = :ID_USUARIO&#13;&#10; WHERE A.ID_MODULO = :ID_MODULO&#13;&#10;  ROWS 1  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C65667403E4000470546F7002280A506172616D65746572730101064B204E616D653D2249445F454E544944414445222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49645F456E746964616465262336323B2200010649204E616D653D2249445F5553554152494F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49645F5573756172696F262336323B2200010647204E616D653D2249445F4D4F44554C4F222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49645F4D6F64756C6F262336323B220000"/>
    <TfrxADOQuery Name="SqlDadosCertidao" UserName="SqlDadosCertidao" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select&#13;&#10; udf_strzero(extract(day from CURRENT_TIMESTAMP), 2) || '/' || udf_strzero(extract(month from CURRENT_TIMESTAMP), 2) ||'/' || udf_strzero(udf_int(extract(year from CURRENT_TIMESTAMP)), 4) as DATA,         &#13;&#10;	udf_strzero(extract(hour from ADE.DATA), 2) || ':' || udf_strzero(extract(minute from ADE.DATA), 2) ||':' || udf_strzero(udf_int(extract(second from ADE.DATA)), 2) as HORA,		&#13;&#10;	udf_incday(ADE.DATA,ADE.DIAS_VALIDADE) as VALIDADE,&#13;&#10;	ADE.NUMERO,&#13;&#10;	ADE.ANO,&#13;&#10;	ADE.DIAS_VALIDADE,&#13;&#10;	ADE.REFERENCIAL &#13;&#10;from AAC_DOCUMENTOS_EMISSAO ADE&#13;&#10;where ADE.REFERENCIAL = :IdReferencial" CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740395000470546F70027E0A506172616D657465727301010660204E616D653D2249645265666572656E6369616C222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B53716C43727970742E262333343B726566636572746964616F262333343B262336323B220000"/>
    <TfrxADOQuery Name="SqlCertidao" UserName="SqlCertidao" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10;cast(:ip_acessado as varchar(30)) as ip_acessado, &#13;&#10;ID_CARNE,&#13;&#10;ID_LANCAMENTO,&#13;&#10;CAMPOS&#13;&#10;FROM IPTU_ITBI_WEB&#13;&#10;WHERE ID_CARNE = :id_carne                                                                 &#13;&#10;          &#13;&#10;    " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C65667403E4000470546F70027C0A506172616D65746572730101064A204E616D653D2269705F616365737361646F222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B69705F616365737361646F262336323B2200010645204E616D653D2269645F6361726E65222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B69645F6361726E65262336323B220000"/>
    <TfrxADOQuery Name="SqlCrypt" UserName="SqlCrypt" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="SqlCertidao" IgnoreDupParams="False" SQL.Text="select CODIGO,REFCERTIDAO from ADE_CRYPT(&#13;&#10;:referencial,&#13;&#10;'CQI',&#13;&#10;4,&#13;&#10;'IPTU',&#13;&#10;-1,&#13;&#10;'')" CommandTimeout="30" LockType="ltReadOnly" PropData="05704C65667402480470546F70027C0A506172616D65746572730101064B204E616D653D227265666572656E6369616C222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B7265666572656E6369616C262336323B220000"/>
    <TfrxADOQuery Name="SqlCarne" UserName="SqlCarne" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select&#13;&#10; 	D.I000,&#13;&#10; 	D.REFERENCIAL_IMOVEIS as REF_ORIGEM,&#13;&#10; 	udf_strzero(extract(day from C.DATA_CRIACAO), 2) || '/' || udf_strzero(extract(month from C.DATA_CRIACAO), 2) ||'/' || udf_strzero(udf_int(extract(year from C.DATA_CRIACAO)), 4) as DATA_CRIACAO,&#13;&#10; 	udf_strzero(extract(day from Z.DATA_PAGTO)  , 2) || '/' || udf_strzero(extract(month from Z.DATA_PAGTO)  , 2) ||'/' || udf_strzero(udf_int(extract(year from Z.DATA_PAGTO))  , 4) as DATA_QUITACAO,&#13;&#10; 	substring(C.COMPETENCIA from 1 for 4) as EXERCICIO,&#13;&#10; 	C.STATUS as STATUS_CARNE,&#13;&#10;  Z.VL_PARCELA as VL_PARCELA,&#13;&#10;  Z.VLR_PAGO   as VLR_PAGO&#13;&#10;from 	IPTU_CARNES C&#13;&#10;left join&#13;&#10; 	IPTU_DADOS_ANUAIS D on D.REFERENCIAL = C.REFERENCIAL_DADOS&#13;&#10;left join LATERAL(&#13;&#10;&#13;&#10;	select &#13;&#10;    	max(P.DATA_PAGTO) as DATA_PAGTO,&#13;&#10;     sum(P.VALOR)      as VL_PARCELA,&#13;&#10;     sum(P.VLR_PAGO)   as VLR_PAGO &#13;&#10;    from IPTU_PARCELAS P &#13;&#10;    where &#13;&#10;    	P.REFERENCIAL_CARNE = C.REFERENCIAL &#13;&#10;        and P.STATUS in (4,5,6)&#13;&#10;	&#13;&#10;) Z on true&#13;&#10;where&#13;&#10;	C.REFERENCIAL = :referencia and&#13;&#10;	C.STATUS in (10,8)  " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740326010470546F70027C0A506172616D657465727301010647204E616D653D227265666572656E636961222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B69645F6361726E65262336323B220000"/>
    <TfrxADOQuery Name="SqlExtenso" UserName="SqlExtenso" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select valorextenso from sis_retorna_extenso(0, 'S')    " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740364010470546F70027C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" Frame.Typ="15" MirrorMode="0" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="60,4724678" Left="0" Top="222,99227" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="SqlDadosCertidao" DataSetName="SqlDadosCertidao" RowCount="0">
      <TfrxMemoView Name="Memo30" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="718,1107" Height="24,56692913" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="7754281" Font.Height="-21" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="CERTIDÃO DE QUITAÇÃO DE ITBI"/>
      <TfrxMemoView Name="Memo19" Align="baWidth" AllowVectorExport="True" Left="0" Top="28,21259843" Width="718,1107" Height="24,56692913" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="Número da Certidão: [SqlDadosCertidao.&#34;numero&#34;]/[SqlDadosCertidao.&#34;ano&#34;]">
        <Formats>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxMasterData>
    <TfrxMasterData Name="MasterData3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="407,96891402" Left="0" Top="306,14193" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="SqlCertidao" DataSetName="SqlCertidao" RowCount="0">
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="7,18110236" Top="21,8423" Width="700,3153048" Height="63,69295" OnBeforePrint="Memo1OnBeforePrint" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="0" HAlign="haBlock" ParentFont="False" Text="">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
          <item FormatStr="dd/mm/yyyy" Kind="fkDateTime"/>
          <item FormatStr="%2.2n" Kind="fkNumeric"/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo35" AllowVectorExport="True" Left="7,18110236" Top="132,8423" Width="89,66141732" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" ParentFont="False" VAlign="vaCenter" Text="Transmitente:"/>
      <TfrxMemoView Name="Memo36" AllowVectorExport="True" Left="96,66141732" Top="132,8423" Width="377,95275591" Height="18,89765" OnBeforePrint="Memo36OnBeforePrint" DataSet="SqlCertidao" DataSetName="SqlCertidao" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" ParagraphGap="4" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo37" AllowVectorExport="True" Left="7,18110236" Top="151,69291339" Width="89,57480315" Height="18,8976378" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Adquirente:"/>
      <TfrxMemoView Name="Memo38" AllowVectorExport="True" Left="96,67716535" Top="151,69291339" Width="377,95275591" Height="18,89765" OnBeforePrint="Memo38OnBeforePrint" DataSet="SqlCertidao" DataSetName="SqlCertidao" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" ParagraphGap="4" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="n_cpf_cnpj" AllowVectorExport="True" Left="561,03940913" Top="151,69291339" Width="149,38584874" Height="18,89765" OnBeforePrint="Memo25OnBeforePrint" StretchMode="smActualHeight" AllowHTMLTags="True" DataSet="SqlCertidao" DataSetName="SqlCertidao" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" ParagraphGap="4" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo2" AllowVectorExport="True" Left="475,03549409" Top="132,8423" Width="86,00393701" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="CPF / CNPJ:"/>
      <TfrxMemoView Name="Memo3" AllowVectorExport="True" Left="475,05124212" Top="151,69291339" Width="86,00393701" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="CPF / CNPJ:"/>
      <TfrxMemoView Name="m_cpf_cnpj" AllowVectorExport="True" Left="561,0236611" Top="132,8423" Width="149,29136055" Height="18,89765" OnBeforePrint="Memo4OnBeforePrint" DataSet="SqlCertidao" DataSetName="SqlCertidao" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" ParagraphGap="4" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo11" AllowVectorExport="True" Left="7" Top="103,82677165" Width="306,14173228" Height="27,96850394" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" Fill.BackColor="15790320" ParagraphGap="4" ParentFont="False" VAlign="vaCenter" Text="Identificação no Cadastro"/>
      <TfrxMemoView Name="Memo12" AllowVectorExport="True" Left="7" Top="207,047" Width="694,48825" Height="89,89765" OnBeforePrint="Memo12OnBeforePrint" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" Frame.Typ="0" HAlign="haBlock" ParentFont="False" Text="">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
    </TfrxMasterData>
    <TfrxPageHeader Name="bndCabecalho" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="144,92129402" Left="0" Top="18,89765" Width="718,1107">
      <TfrxPictureView Name="Picture2" AllowVectorExport="True" Left="7,55906" Top="9" Width="75,59055118" Height="75,59055118" DataField="LOGOTIPO" DataSet="SqlCliente" DataSetName="SqlCliente" Frame.Typ="0" HightQuality="False" Transparent="False" TransparentColor="16777215"/>
      <TfrxMemoView Name="Memo21" AllowVectorExport="True" Left="100,378015" Top="9,07086614" Width="614,35467" Height="24,56692913" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="[SqlCliente.&#34;NOME&#34;]"/>
      <TfrxMemoView Name="Memo22" AllowVectorExport="True" Left="100,378015" Top="36,89765" Width="614,17322835" Height="17,00787402" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="[SqlCliente.&#34;ENDERECO&#34;] - [SqlCliente.&#34;BAIRRO&#34;] "/>
      <TfrxMemoView Name="Memo23" AllowVectorExport="True" Left="100,378015" Top="55,01577" Width="614,17322835" Height="17,00787402" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="CEP [SqlCliente.&#34;CEP&#34;] - [SqlCliente.&#34;NOME_MUNICIPIO&#34;] - [SqlCliente.&#34;UF&#34;]">
        <Formats>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxMemoView Name="Memo24" AllowVectorExport="True" Left="100,378015" Top="74,47248" Width="614,17322835" Height="17,00787402" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Tel: [SqlCliente.&#34;TELEFONE&#34;]"/>
      <TfrxMemoView Name="m_cpf_cnpj_entidade" AllowVectorExport="True" Left="140,378015" Top="93,03154" Width="574,17322835" Height="17,00787402" OnBeforePrint="Memo25OnBeforePrint" DataSet="SqlCliente" DataSetName="SqlCliente" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" ParentFont="False" Text=" [SqlCliente.&#34;CNPJ&#34;]"/>
      <TfrxMemoView Name="Memo25" AllowVectorExport="True" Left="100,5" Top="92,98423" Width="39,98825" Height="16,89765" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Tahoma" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="CNPJ:"/>
      <TfrxLineView Name="Line1" AllowVectorExport="True" Left="0" Top="109,98423" Width="718" Height="0" Color="0" Frame.Typ="4"/>
    </TfrxPageHeader>
    <TfrxPageFooter Name="bndRodape" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="183,38582677" Left="0" Top="774,80365" Width="718,1107" OnBeforePrint="bndRodapeOnBeforePrint">
      <TfrxLineView Name="Line2" Align="baWidth" AllowVectorExport="True" Left="0" Top="0" Width="718,1107" Height="0" Restrictions="31" Color="15793151" Frame.Color="15793151" Frame.Typ="4"/>
      <TfrxMemoView Name="TxtRodape" AllowVectorExport="True" Left="0" Top="169,04724409" Width="302,36243661" Height="11,33858268" Visible="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" ParentFont="False" Text="TxtRodape"/>
      <TfrxMemoView Name="TxtPaginacao" AllowVectorExport="True" Left="415,74826339" Top="169" Width="302,36243661" Height="11,33859" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" HAlign="haRight" ParentFont="False" Text="Página [Page#] de [TotalPages#]"/>
      <TfrxMemoView Name="TxtDataHora" AllowVectorExport="True" Left="302,36243661" Top="169" Width="113,38582677" Height="11,33858268" Restrictions="16" DisplayFormat.FormatStr="dd/MM/yyyy HH:mm:ss" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Tahoma" Font.Style="0" Font.Quality="fqClearTypeNatural" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[Now]"/>
      <TfrxMemoView Name="Memo26" AllowVectorExport="True" Left="7,05906" Top="7,89765" Width="705,0948348" Height="165,24411402" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Tahoma" Font.Style="0" Frame.Typ="0" HAlign="haBlock" ParentFont="False" Text="&#13;&#10;Certidão emitida em &#60;b&#62;[SqlDadosCertidao.&#34;data&#34;]&#60;/b&#62; ás &#60;b&#62;[SqlDadosCertidao.&#34;hora&#34;]&#60;/b&#62; (data e hora de Brasília).&#13;&#10;Acessada pelo IP: &#60;b&#62;[SqlCertidao.&#34;ip_acessado&#34;]&#60;/b&#62;&#13;&#10;Código de Controle da Certidão: &#60;b&#62;[Sqlcrypt.&#34;codigo&#34;]&#60;/b&#62;&#13;&#10;&#13;&#10;A autenticidade desta certidão pode ser confirmada na página da Prefeitura na Internet, no endereço &#60;u&#62;[SqlCliente.&#34;site&#34;]&#60;/u&#62;&#13;&#10;&#13;&#10;&#60;b&#62;OBS:&#60;/b&#62; Os valores de lançamento estão sujeitos a mudança, para mais detalhes entre em contato com a prefeitura.">
        <Formats>
          <item/>
          <item/>
          <item/>
          <item/>
          <item/>
        </Formats>
      </TfrxMemoView>
      <TfrxLineView Name="Line3" AllowVectorExport="True" Left="0" Top="166,74026" Width="718" Height="0" Color="0" Frame.Typ="4"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
